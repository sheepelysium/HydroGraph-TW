# 水文知識庫 RAG 系統使用說明

## 特點
✅ **超快速** - 使用 Google Gemini-2.5-Flash，查詢約 4-5 秒
✅ **簡單** - 不需要額外的向量資料庫或複雜配置
✅ **免費** - 使用 Google Gemini 免費額度
✅ **LangGraph** - 使用 LangGraph 構建清晰的 RAG 流程

## 快速開始

### 1. 確認環境

系統已自動從 `.env` 檔案載入 API Key，確保 `.env` 中有：

```
GOOGLE_API_KEY=你的API金鑰
```

### 2. 啟動虛擬環境並運行

```bash
# Windows
hydro_env\Scripts\activate
python simple_rag.py
```

### 3. 使用系統

程式會自動執行三個測試查詢，然後進入互動模式。輸入你的問題即可查詢。

輸入 `quit`, `exit`, `q` 或 `退出` 來結束程式。

## 系統架構

```
問題輸入
   ↓
[檢索節點] - 從知識庫中找到相關內容（關鍵詞匹配）
   ↓
[生成節點] - 使用 Gemini 根據檢索到的內容生成答案
   ↓
返回答案
```

## 示例查詢

- "什麼是一級警戒水位？"
- "颱風來臨前要準備什麼？"
- "淹水超過多高可以申請補助？"
- "土石流警戒有哪些級別？"
- "緊急聯絡電話是多少？"

## 性能對比

| 系統 | 查詢時間 | 成本 |
|------|---------|------|
| DIFY | ~5 秒 | 可能需付費 |
| 本系統 | ~4-5 秒 | 免費 |

## 技術細節

- **文檔分塊**: 簡單按章節和行數分塊（共 43 塊）
- **檢索方法**: 關鍵詞匹配（不使用向量嵌入）
- **LLM**: Google Gemini-2.5-Flash（免費額度充足）
- **框架**: LangGraph（清晰的狀態管理）

## 已知限制

### 檢索效果
目前使用簡單的關鍵詞匹配，對於某些查詢效果不佳。如需改進，可以：

1. **使用向量嵌入**（會增加複雜度和時間）
2. **改進分詞**（使用中文分詞工具如 jieba）
3. **增加同義詞匹配**

### 改進建議

如果需要更好的檢索效果，建議：
- 使用 Gemini 的嵌入 API（需額外調用）
- 或使用 FAISS/Chroma 等向量資料庫
- 這會讓初始化時間稍長，但檢索會更準確

## 疑難排解

### 編碼問題
如果看到亂碼，這是 Windows 命令行的編碼問題，不影響功能。

### API Key 錯誤
確認 `.env` 檔案中的 `GOOGLE_API_KEY` 是有效的。

### 模型不可用
如果出現模型不存在錯誤，可能是 Google 更新了模型列表。可查看可用模型並修改程式碼中的模型名稱。
