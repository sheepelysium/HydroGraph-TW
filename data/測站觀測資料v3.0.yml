app:
  description: è¼¸å…¥å…­åƒæ•¸
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: æ¸¬ç«™è§€æ¸¬è³‡æ–™v3.0
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/ollama:0.0.8@22213ae036605d41ea73bdd16908e03de1b9d5ab4656a49b8fb0343723f4cb4a
    version: null
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/azure_openai:0.0.30@c60f0c8612961bb634b9209703ed91fc752713b14399a1522a72320b46ef6185
    version: null
kind: app
version: 0.4.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: start
        targetType: code
      id: 1749807739897-source-1749807861742-target
      selected: false
      source: '1749807739897'
      sourceHandle: source
      target: '1749807861742'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1750036748953'
        sourceType: iteration-start
        targetType: knowledge-retrieval
      id: 1750036748953start-source-1750036763346-target
      source: 1750036748953start
      sourceHandle: source
      target: '1750036763346'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: iteration
        targetType: code
      id: 1750036748953-source-1750037499341-target
      source: '1750036748953'
      sourceHandle: source
      target: '1750037499341'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: template-transform
        targetType: end
      id: 1750058389563-source-1749807756704-target
      source: '1750058389563'
      sourceHandle: source
      target: '1749807756704'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: if-else
      id: 1750037499341-source-1750063100583-target
      source: '1750037499341'
      sourceHandle: source
      target: '1750063100583'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: 1750063100583-true-1750043258451-target
      source: '1750063100583'
      sourceHandle: 'true'
      target: '1750043258451'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: template-transform
        targetType: end
      id: 1750130176499-source-1750063110498-target
      source: '1750130176499'
      sourceHandle: source
      target: '1750063110498'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: template-transform
      id: 1750063100583-1f534004-da2c-4056-b3a5-86613eba9478-1750130176499-target
      source: '1750063100583'
      sourceHandle: 1f534004-da2c-4056-b3a5-86613eba9478
      target: '1750130176499'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: if-else
      id: 1749807861742-source-1750214671657-target
      source: '1749807861742'
      sourceHandle: source
      target: '1750214671657'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: iteration
      id: 1750214671657-true-1750036748953-target
      source: '1750214671657'
      sourceHandle: 'true'
      target: '1750036748953'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: template-transform
      id: 1750214671657-e2529f5e-b60f-4aad-95f7-0c2e25bf902e-1750214858474-target
      source: '1750214671657'
      sourceHandle: e2529f5e-b60f-4aad-95f7-0c2e25bf902e
      target: '1750214858474'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: template-transform
        targetType: end
      id: 1750214858474--1750214871930-target
      source: '1750214858474'
      sourceHandle: source
      target: '1750214871930'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1750043258451-source-1750401071179-target
      source: '1750043258451'
      sourceHandle: source
      target: '1750401071179'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: template-transform
      id: 1750401071179-source-1750058389563-target
      source: '1750401071179'
      sourceHandle: source
      target: '1750058389563'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: é–‹å§‹
        type: start
        variables:
        - label: location
          max_length: 128
          options: []
          required: true
          type: text-input
          variable: location
        - label: dataType
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: dataType
        - label: startDate
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: startDate
        - label: endDate
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: endDate
        - label: userQuery
          max_length: 256
          options: []
          required: true
          type: text-input
          variable: userQuery
        - label: searchQueries
          max_length: 256
          options: []
          required: false
          type: paragraph
          variable: searchQueries
      height: 218
      id: '1749807739897'
      position:
        x: 30
        y: 310
      positionAbsolute:
        x: 30
        y: 310
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1750058389563'
          - output
          variable: output
        selected: false
        title: çµæŸ
        type: end
      height: 88
      id: '1749807756704'
      position:
        x: 3030
        y: 450
      positionAbsolute:
        x: 3030
        y: 450
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "from __future__ import annotations\nimport json\nimport re\nfrom typing\
          \ import Any, Dict, List\n\ndef normalize_datatype(dataType: str) -> str:\n\
          \    \"\"\"å°‡ç”¨æˆ¶è¼¸å…¥çš„è³‡æ–™é¡å‹æ¨™æº–åŒ–ç‚ºçŸ¥è­˜æª¢ç´¢ç”¨çš„å®Œæ•´åç¨±\"\"\"\n    if not dataType or not dataType.strip():\n\
          \        return dataType\n    \n    dataType_lower = dataType.lower().strip()\n\
          \    \n    # \U0001F3AF ä¿®æ­£ï¼šæŠŠæ›´å…·é«”çš„é—œéµå­—æ”¾å‰é¢ï¼Œé¿å…æ­§ç¾©\n    if any(keyword in dataType_lower\
          \ for keyword in [\"åœ°ä¸‹æ°´\", \"äº•\", \"åœ°ä¸‹æ°´ä½\"]):\n        return \"åœ°ä¸‹æ°´ä½\"\n\
          \    elif any(keyword in dataType_lower for keyword in [\"é›¨é‡\", \"é™é›¨\",\
          \ \"é›¨æ°´\"]):\n        return \"é›¨é‡\"  \n    elif any(keyword in dataType_lower\
          \ for keyword in [\"æ°´ä½\", \"æµé‡\", \"å«æ²™é‡\", \"æ²³å·\"]):\n        return \"\
          æ°´ä½æµé‡å«æ²™é‡\"\n    \n    # å¦‚æœæ²’æœ‰åŒ¹é…åˆ°ï¼Œä¿æŒåŸå€¼\n    return dataType\n\ndef is_multi_query_semantic(text:\
          \ str) -> bool:\n    \"\"\"\U0001F195 èªç¾©æª¢æ¸¬ - æª¢æ¸¬æ˜¯å¦ç‚ºå¤šçµæœæŸ¥è©¢\"\"\"\n    if not\
          \ text:\n        return False\n    \n    text_lower = text.lower().strip()\n\
          \    \n    # \U0001F3AF ç¯„åœæŸ¥è©¢è©æª¢æ¸¬\n    range_triggers = any(word in text_lower\
          \ for word in [\"å“ªäº›\", \"é™„è¿‘\", \"æ‰€æœ‰\", \"æµåŸŸ\", \"æœ‰ä»€éº¼\", \"åŒ…å«å“ªäº›\", \"å«æœ‰å“ªäº›\"\
          ])\n    \n    # \U0001F3AF å€åŸŸæ€§åœ°ç†æŸ¥è©¢æª¢æ¸¬ï¼ˆç²¾ç¢ºåŒ¹é…ï¼‰\n    regional_patterns = [\n\
          \        r'.+æœ‰.+[æ¸¬é‡]ç«™[å—ï¼Ÿ]?',     # XXæœ‰XXæ¸¬ç«™å—\n        r'.+æ˜¯å¦æœ‰.+[æ¸¬é‡]ç«™',  \
          \      # XXæ˜¯å¦æœ‰XXæ¸¬ç«™\n        r'.+åŒ…å«.+[æ¸¬é‡]ç«™',          # XXåŒ…å«XXæ¸¬ç«™\n      \
          \  r'.+è¨­æœ‰.+[æ¸¬é‡]ç«™[å—ï¼Ÿ]?',   # XXè¨­æœ‰XXæ¸¬ç«™å—\n        r'.+å­˜åœ¨.+[æ¸¬é‡]ç«™[å—ï¼Ÿ]?'    #\
          \ XXå­˜åœ¨XXæ¸¬ç«™å—\n    ]\n    regional_triggers = any(re.search(pattern, text_lower)\
          \ for pattern in regional_patterns)\n    \n    # \U0001F3AF å¤šè³‡æ–™é¡å‹æª¢æ¸¬\n  \
          \  multi_type_triggers = any(word in text_lower for word in [\"å’Œ\", \"èˆ‡\"\
          , \"åŠ\", \"æ¯”è¼ƒ\", \"å°æ¯”\", \"éƒ½\", \"åˆ†åˆ¥\", \"ä»¥åŠ\"])\n    \n    return range_triggers\
          \ or regional_triggers or multi_type_triggers\n\ndef main(\n    location:\
          \ str = \"\",\n    dataType: str = \"\",\n    startDate: str = \"\",\n \
          \   endDate: str = \"\",\n    userQuery: str = \"\",\n    searchQueries:\
          \ Any = None,  # å¯èƒ½æ˜¯ str æˆ– list\n    **kwargs,\n) -> Dict[str, Any]:\n \
          \   \"\"\"çµ±ä¸€è§£æåƒæ•¸ã€è½‰æ› searchQueries æ ¼å¼ã€æ¨è«–è³‡æ–™é¡å‹ã€‚\"\"\"\n\n    # 1. searchQueries\
          \ è½‰æˆ list[str]ï¼Œå¼·åŒ–è™•ç† JSON å­—ä¸² + éåº¦ escape\n    searchQueries_list: List[str]\
          \ = []\n\n    if searchQueries is None:\n        searchQueries_list = []\n\
          \n    elif isinstance(searchQueries, list):\n        searchQueries_list\
          \ = [str(x).strip() for x in searchQueries if str(x).strip()]\n\n    elif\
          \ isinstance(searchQueries, str):\n        cleaned_searchQueries = searchQueries.strip()\n\
          \        try:\n            # å˜—è©¦ç§»é™¤å¤šé¤˜çš„è·³è„«ç¬¦è™Ÿï¼Œä¾‹å¦‚ [\\\\\\\"ä¸­æ­£æ©‹æ°´ä½\\\\\\\"]\n  \
          \          if cleaned_searchQueries.startswith('[\"') and '\\\\\"' in cleaned_searchQueries:\n\
          \                cleaned_searchQueries = re.sub(r'\\\\(.)', r'\\1', cleaned_searchQueries)\n\
          \n            parsed = json.loads(cleaned_searchQueries)\n            if\
          \ isinstance(parsed, list):\n                searchQueries_list = [str(x).strip()\
          \ for x in parsed if str(x).strip()]\n            else:\n              \
          \  searchQueries_list = [str(parsed).strip()]\n        except Exception:\n\
          \            searchQueries_list = [cleaned_searchQueries]\n    else:\n \
          \       searchQueries_list = [str(searchQueries).strip()]\n\n    # å¦‚æœ searchQueries\
          \ ç‚ºç©ºï¼Œä½¿ç”¨åŸå§‹æŸ¥è©¢\n    if not searchQueries_list and userQuery.strip():\n    \
          \    searchQueries_list = [userQuery.strip()]\n\n    # \U0001F195 èªç¾©æª¢æ¸¬å„ªå…ˆè™•ç†ï¼ˆåœ¨æ‰€æœ‰é‚è¼¯ä¹‹å‰ï¼‰\n\
          \    all_text = \" \".join([userQuery] + searchQueries_list).strip()\n \
          \   if is_multi_query_semantic(all_text):\n        final_dataType = \"å¤šçµæœæŸ¥è©¢\"\
          \n    elif normalize_datatype(dataType) == \"å¤šçµæœæŸ¥è©¢\":\n        # å¦‚æœå‚³å…¥çš„ dataType\
          \ å·²ç¶“æ˜¯ã€Œå¤šçµæœæŸ¥è©¢ã€ï¼Œç›´æ¥æ¡ç”¨ï¼Œä¸å†åˆ†æ searchQueries\n        final_dataType = \"å¤šçµæœæŸ¥è©¢\"\
          \n    else:\n        # 2. å…ˆæ¨™æº–åŒ– dataType\n        normalized_dataType = normalize_datatype(dataType)\n\
          \n        # 3. æ ¹æ“š searchQueries å…§å®¹æª¢æ¸¬è³‡æ–™é¡å‹\n        valid_types = {\n    \
          \        \"é›¨é‡\": [\"é›¨é‡\", \"é™é›¨\", \"é›¨æ°´\"],\n            \"æ°´ä½æµé‡å«æ²™é‡\": [\"\
          æ°´ä½\", \"æµé‡\", \"å«æ²™é‡\", \"æ²³å·\"],\n            \"åœ°ä¸‹æ°´ä½\": [\"åœ°ä¸‹æ°´\", \"åœ°ä¸‹æ°´ä½\"\
          , \"è§€æ¸¬äº•\", \"äº•\"],\n        }\n\n        detected_types = set()\n      \
          \  for item in searchQueries_list:\n            lowered = item.lower()\n\
          \            for dtype, keywords in valid_types.items():\n             \
          \   if any(k in lowered for k in keywords):\n                    detected_types.add(dtype)\n\
          \n        # 4. æ±ºå®šæœ€çµ‚çš„ final_dataType\n        if len(searchQueries_list)\
          \ > 1 and len(detected_types) > 1:\n            # åŸæœ‰é‚è¼¯ï¼šå¾ searchQueries ä¸­æª¢æ¸¬åˆ°å¤šç¨®é¡å‹\n\
          \            final_dataType = \"å¤šçµæœæŸ¥è©¢\"\n        elif len(detected_types)\
          \ == 1:\n            # åŸæœ‰é‚è¼¯ï¼šå¾ searchQueries ä¸­æª¢æ¸¬åˆ°å–®ä¸€é¡å‹\n            final_dataType\
          \ = list(detected_types)[0]\n        else:\n            # åŸæœ‰é‚è¼¯ï¼šsearchQueries\
          \ ä¸­ç„¡æœ‰æ•ˆé¡å‹ï¼Œå›é€€åˆ°æ¨™æº–åŒ–å¾Œçš„ dataType\n            final_dataType = normalized_dataType\n\
          \n    # 5. åªæª¢æŸ¥çœŸæ­£éœ€è¦çš„æ¬„ä½ï¼Œä¸æª¢æŸ¥ searchQueries\n    missing = [k for k, v in {\n\
          \        \"location\": location,\n        \"dataType\": final_dataType,\n\
          \        \"startDate\": startDate,\n        \"endDate\": endDate,\n    }.items()\
          \ if not v]\n    \n    status = \"incomplete\" if missing else \"success\"\
          \n\n    # 6. å›å‚³æ ¼å¼\n    return {\n        \"location\": location,\n     \
          \   \"dataType\": final_dataType,\n        \"startDate\": startDate,\n \
          \       \"endDate\": endDate,\n        \"userQuery\": userQuery,\n     \
          \   \"searchQueries\": searchQueries_list,\n        \"status\": status,\n\
          \        \"incomplete_fields\": missing,\n        \"error_msg\": \"\" if\
          \ status == \"success\" else f\"ç¼ºå°‘: {', '.join(missing)}\",\n    }"
        code_language: python3
        desc: ''
        outputs:
          dataType:
            children: null
            type: string
          endDate:
            children: null
            type: string
          error_msg:
            children: null
            type: string
          incomplete_fields:
            children: null
            type: array[string]
          location:
            children: null
            type: string
          searchQueries:
            children: null
            type: array[string]
          startDate:
            children: null
            type: string
          status:
            children: null
            type: string
          userQuery:
            children: null
            type: string
        selected: false
        title: è§£æç”¨æˆ¶è¼¸å…¥
        type: code
        variables:
        - value_selector:
          - '1749807739897'
          - location
          variable: location
        - value_selector:
          - '1749807739897'
          - dataType
          variable: dataType
        - value_selector:
          - '1749807739897'
          - startDate
          variable: startDate
        - value_selector:
          - '1749807739897'
          - endDate
          variable: endDate
        - value_selector:
          - '1749807739897'
          - userQuery
          variable: userQuery
        - value_selector:
          - '1749807739897'
          - searchQueries
          variable: searchQueries
      height: 52
      id: '1749807861742'
      position:
        x: 332.11308451104276
        y: 310
      positionAbsolute:
        x: 332.11308451104276
        y: 310
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        error_handle_mode: terminated
        height: 278.50380250832876
        is_parallel: true
        iterator_selector:
        - '1749807861742'
        - searchQueries
        output_selector:
        - '1750036763346'
        - result
        output_type: array[object]
        parallel_nums: 10
        selected: false
        start_node_id: 1750036748953start
        title: è¿­ä»£
        type: iteration
        width: 508
      height: 279
      id: '1750036748953'
      position:
        x: 944.880979607211
        y: 277.46875708966166
      positionAbsolute:
        x: 944.880979607211
        y: 277.46875708966166
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 508
      zIndex: 1
    - data:
        desc: ''
        isInIteration: true
        selected: false
        title: ''
        type: iteration-start
      draggable: false
      height: 48
      id: 1750036748953start
      parentId: '1750036748953'
      position:
        x: 60
        y: 82
      positionAbsolute:
        x: 1004.880979607211
        y: 359.46875708966166
      selectable: false
      sourcePosition: right
      targetPosition: left
      type: custom-iteration-start
      width: 44
      zIndex: 1002
    - data:
        dataset_ids:
        - ZTPx9afl7Li0HMs8y8429quJqKDQfroCo4NLwdy7mbzwkXjHSJekexEjITNzhjAZ
        - NhQ1VRTfIvcco/vcDT/dTKd4KIKZvL8bJPKsVMHa5KNMbi9zQisPmhN4oURWzKq5
        desc: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1750036748953'
        metadata_filtering_conditions:
          conditions:
          - comparison_operator: is
            id: f5a5f60e-adee-432a-b43a-7f822f1c7c37
            name: type
          - comparison_operator: is
            id: a9de3214-4033-482b-a3c9-bf2acb397114
            name: type
            value: '{{#1749807861742.dataType#}}'
          logical_operator: and
        metadata_filtering_mode: manual
        multiple_retrieval_config:
          reranking_enable: false
          reranking_mode: weighted_score
          reranking_model:
            model: netease-youdao/bce-reranker-base_v1
            provider: langgenius/siliconflow/siliconflow
          score_threshold: 0.4
          top_k: 4
          weights:
            keyword_setting:
              keyword_weight: 0.3
            vector_setting:
              embedding_model_name: bge-m3
              embedding_provider_name: langgenius/ollama/ollama
              vector_weight: 0.7
        query_variable_selector:
        - '1750036748953'
        - item
        retrieval_mode: multiple
        selected: true
        title: çŸ¥è­˜æª¢ç´¢
        type: knowledge-retrieval
      height: 118
      id: '1750036763346'
      parentId: '1750036748953'
      position:
        x: 201.39467672577825
        y: 83.77435372603742
      positionAbsolute:
        x: 1146.2756563329892
        y: 361.2431108156991
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
      zIndex: 1002
    - data:
        code: "def main(location=\"\", dataType=\"\", startDate=\"\", endDate=\"\"\
          , Integration=None, **kwargs):\n    \"\"\"\n    æœ€çµ‚ç°¡åŒ–ç‰ˆæ¸¬ç«™è™•ç† - ä¿®æ­£ time_filtered_stations\
          \ å»é‡å•é¡Œ\n    \"\"\"\n    import json\n    \n    try:\n        # åŸºæœ¬åƒæ•¸æª¢æŸ¥\n\
          \        raw_stations = extract_raw_stations(Integration)\n        if not\
          \ raw_stations:\n            return {\n                \"stationsData\"\
          : [],\n                \"queryInfo\": {\n                    \"location\"\
          : location,\n                    \"dataType\": dataType,\n             \
          \       \"timeRange\": f\"{startDate} è‡³ {endDate}\" if startDate and endDate\
          \ else \"æœªæŒ‡å®š\",\n                    \"foundStations\": 0,\n           \
          \         \"stationNames\": [],\n                    \"result_type\": \"\
          no_match\"\n                },\n                \"debug_info\": {\n    \
          \                \"raw_count\": 0,\n                    \"time_filtered_stations\"\
          : [],\n                    \"failed_reasons\": {}\n                }\n \
          \           }\n        \n        # è™•ç†æ¸¬ç«™è³‡æ–™\n        valid_stations = []\n\
          \        time_filtered_candidates = []\n        failed_reasons = {}\n  \
          \      \n        # æå–æŸ¥è©¢æ™‚é–“ç¯„åœ\n        query_years = extract_query_years(startDate,\
          \ endDate)\n        \n        for item in raw_stations:\n            station_info\
          \ = parse_and_validate_station(item, dataType)\n            \n         \
          \   if station_info:\n                # æ™‚é–“ç¯„åœæª¢æŸ¥\n                time_check_result\
          \ = check_time_range(station_info, query_years)\n                \n    \
          \            if time_check_result[\"matches\"]:\n                    valid_stations.append(station_info)\n\
          \                else:\n                    # å…ˆæš«å­˜ï¼Œç¨å¾Œå»é‡\n               \
          \     time_filtered_candidates.append({\n                        \"station_name\"\
          : station_info.get('station_name'),\n                        \"station_code\"\
          : station_info.get('station_code'),\n                        \"data_category\"\
          : station_info.get('data_category'),\n                        \"data_periods\"\
          : station_info.get(\"data_periods\", {}),\n                        \"time_details\"\
          : time_check_result[\"details\"]\n                    })\n            else:\n\
          \                # çµ±è¨ˆå¤±æ•—åŸå› \n                fail_reason = analyze_failure_reason(item,\
          \ dataType)\n                if fail_reason in failed_reasons:\n       \
          \             failed_reasons[fail_reason] += 1\n                else:\n\
          \                    failed_reasons[fail_reason] = 1\n        \n       \
          \ # å° time_filtered_candidates é€²è¡Œå»é‡\n        time_filtered_stations = deduplicate_time_filtered_stations(time_filtered_candidates)\n\
          \        \n        # è™•ç†æˆåŠŸçš„æ¸¬ç«™\n        stations_with_urls = []\n        if\
          \ valid_stations:\n            for station in valid_stations:\n        \
          \        api_url = build_station_url(\n                    station.get(\"\
          station_code\", \"\"),\n                    station.get(\"data_category\"\
          , \"\"),\n                    startDate,\n                    endDate\n\
          \                )\n                station_data = build_complete_station_data(station,\
          \ api_url)\n                stations_with_urls.append(json.dumps(station_data,\
          \ ensure_ascii=False))\n            \n            # å»é‡è™•ç†\n            unique_stations\
          \ = remove_duplicate_stations(stations_with_urls)\n        else:\n     \
          \       unique_stations = []\n        \n        # åˆ¤æ–· result_type\n     \
          \   if len(unique_stations) > 0:\n            result_type = \"success\"\n\
          \        elif len(time_filtered_stations) > 0:\n            result_type\
          \ = \"time_filtered\"\n        elif failed_reasons.get(\"æ¸¬ç«™å·²å»¢\", 0) > 0:\n\
          \            # æª¢æŸ¥æ˜¯å¦æ¸¬ç«™å·²å»¢æ˜¯ä¸»è¦åŸå› \n            obsolete_count = failed_reasons.get(\"\
          æ¸¬ç«™å·²å»¢\", 0)\n            total_failed = sum(failed_reasons.values())\n  \
          \          if obsolete_count >= total_failed / 2:  # å·²å»¢ä½”ä¸€åŠä»¥ä¸Š\n         \
          \       result_type = \"obsolete\"\n            else:\n                result_type\
          \ = \"no_match\"\n        else:\n            result_type = \"no_match\"\n\
          \        \n        return {\n            \"stationsData\": unique_stations,\n\
          \            \"queryInfo\": {\n                \"location\": location,\n\
          \                \"dataType\": dataType,\n                \"timeRange\"\
          : f\"{startDate} è‡³ {endDate}\" if startDate and endDate else \"æœªæŒ‡å®š\",\n\
          \                \"foundStations\": len(unique_stations),\n            \
          \    \"stationNames\": [json.loads(s).get(\"station_name\", \"\") for s\
          \ in unique_stations[:5]],\n                \"result_type\": result_type\n\
          \            },\n            \"debug_info\": {\n                \"raw_count\"\
          : len(raw_stations),\n                \"time_filtered_stations\": time_filtered_stations,\n\
          \                \"failed_reasons\": failed_reasons,\n                \"\
          query_years\": query_years\n            }\n        }\n        \n    except\
          \ Exception as e:\n        return {\n            \"stationsData\": [],\n\
          \            \"queryInfo\": {\n                \"location\": location,\n\
          \                \"dataType\": dataType,\n                \"timeRange\"\
          : f\"{startDate} è‡³ {endDate}\" if startDate and endDate else \"æœªæŒ‡å®š\",\n\
          \                \"foundStations\": 0,\n                \"stationNames\"\
          : [],\n                \"result_type\": \"no_match\"\n            },\n \
          \           \"debug_info\": {\n                \"error\": f\"ç³»çµ±éŒ¯èª¤: {str(e)}\"\
          ,\n                \"raw_count\": 0,\n                \"time_filtered_stations\"\
          : [],\n                \"failed_reasons\": {}\n            }\n        }\n\
          \n\ndef deduplicate_time_filtered_stations(candidates):\n    \"\"\"\n  \
          \  å° time_filtered_stations é€²è¡Œå»é‡\n    æ ¹æ“š station_codeï¼ˆç«™è™Ÿï¼‰å»é‡ï¼Œä¿ç•™ç¬¬ä¸€å€‹\n    \"\
          \"\"\n    if not candidates:\n        return []\n    \n    seen_codes =\
          \ set()\n    unique_stations = []\n    \n    for station in candidates:\n\
          \        station_code = station.get(\"station_code\", \"\")\n        station_name\
          \ = station.get(\"station_name\", \"\")\n        \n        # ä½¿ç”¨ station_code\
          \ ä½œç‚ºå”¯ä¸€æ¨™è­˜ï¼Œå¦‚æœæ²’æœ‰å‰‡ç”¨ station_name\n        unique_key = station_code if station_code\
          \ else station_name\n        \n        if unique_key and unique_key not\
          \ in seen_codes:\n            seen_codes.add(unique_key)\n            #\
          \ ä¿ç•™ station_codeï¼Œæ¨¡æ¿éœ€è¦é¡¯ç¤ºç«™è™Ÿ\n            unique_stations.append(station)\n\
          \    \n    return unique_stations\n\n\n# ===== æ ¸å¿ƒè™•ç†å‡½æ•¸ =====\ndef extract_raw_stations(Integration):\n\
          \    \"\"\"æå–åŸå§‹æ¸¬ç«™è³‡æ–™ - ä¿®æ­£äºŒç¶­é™£åˆ—å•é¡Œ\"\"\"\n    if not Integration:\n        return\
          \ []\n    \n    # è™•ç†å­—å…¸åŒ…è£çš„æƒ…æ³\n    if isinstance(Integration, dict) and \"\
          output\" in Integration:\n        Integration = Integration[\"output\"]\n\
          \    \n    # è™•ç†é™£åˆ—æƒ…æ³\n    if isinstance(Integration, list):\n        # å¦‚æœæ˜¯äºŒç¶­é™£åˆ—ï¼Œæ”¤å¹³å®ƒ\n\
          \        if Integration and isinstance(Integration[0], list):\n        \
          \    return Integration[0]  # å–ç¬¬ä¸€å±¤çš„å…§å®¹\n        return Integration\n    \n\
          \    return []\n\n\ndef extract_query_years(startDate, endDate):\n    \"\
          \"\"æå–æŸ¥è©¢çš„å¹´ä»½ç¯„åœ\"\"\"\n    try:\n        start_year = int(startDate.split('/')[0])\
          \ if startDate else None\n        end_year = int(endDate.split('/')[0])\
          \ if endDate else None\n        return {\n            \"start\": start_year,\n\
          \            \"end\": end_year,\n            \"valid\": bool(start_year\
          \ and end_year)\n        }\n    except:\n        return {\"start\": None,\
          \ \"end\": None, \"valid\": False}\n\n\ndef check_time_range(station_info,\
          \ query_years):\n    \"\"\"æª¢æŸ¥æ¸¬ç«™çš„è³‡æ–™æœŸé–“æ˜¯å¦åŒ…å«æŸ¥è©¢æ™‚é–“ç¯„åœ\"\"\"\n    if not query_years[\"\
          valid\"]:\n        return {\"matches\": True, \"details\": \"ç„¡æ™‚é–“é™åˆ¶\"}\n\
          \    \n    data_periods = station_info.get(\"data_periods\", {})\n    if\
          \ not data_periods:\n        return {\"matches\": False, \"details\": \"\
          ç„¡è³‡æ–™æœŸé–“è³‡è¨Š\"}\n    \n    query_start = query_years[\"start\"]\n    query_end\
          \ = query_years[\"end\"]\n    matching_periods = []\n    \n    for period_type,\
          \ period_range in data_periods.items():\n        if not period_range:\n\
          \            continue\n        \n        # \U0001F195 è™•ç†é€—è™Ÿåˆ†éš”çš„å¤šæ®µæ™‚é–“ (ä¾‹å¦‚: \"\
          1963,1965~1969,1971~2025\")\n        segments = [s.strip() for s in period_range.split(',')]\n\
          \        \n        for segment in segments:\n            try:\n        \
          \        if '~' in segment:\n                    start_str, end_str = segment.split('~')\n\
          \                    period_start = int(start_str.strip())\n           \
          \         period_end = int(end_str.strip())\n                else:\n   \
          \                 period_start = period_end = int(segment.strip())\n   \
          \             \n                # æª¢æŸ¥æ˜¯å¦æœ‰é‡ç–Š\n                if period_start\
          \ <= query_end and period_end >= query_start:\n                    matching_periods.append(f\"\
          {period_type}({period_range})\")\n                    break  # é€™å€‹è³‡æ–™é¡å‹å·²ç¶“åŒ¹é…ï¼Œä¸éœ€è¦å†æª¢æŸ¥å…¶ä»–ç‰‡æ®µ\n\
          \                    \n            except (ValueError, IndexError):\n  \
          \              continue\n    \n    if matching_periods:\n        return\
          \ {\"matches\": True, \"details\": f\"ç¬¦åˆæœŸé–“: {', '.join(matching_periods)}\"\
          }\n    else:\n        available_periods = [f\"{k}({v})\" for k, v in data_periods.items()\
          \ if v]\n        return {\"matches\": False, \"details\": f\"å¯ç”¨æœŸé–“: {', '.join(available_periods)\
          \ if available_periods else 'ç„¡'}\"}\n\n\ndef parse_and_validate_station(item,\
          \ target_data_type):\n    \"\"\"è§£æä¸¦é©—è­‰æ¸¬ç«™ - ä¿®å¾©å¤šçµæœæŸ¥è©¢é‚è¼¯\"\"\"\n    if not isinstance(item,\
          \ dict):\n        return None\n        \n    content = item.get(\"content\"\
          , \"\")\n    if not content:\n        return None\n    \n    station_data\
          \ = parse_content_fields(content)\n    if not station_data:\n        return\
          \ None\n    \n    station_name = station_data.get('ç«™å', '').strip()\n  \
          \  category = station_data.get('é¡åˆ¥', '').strip()\n    status = station_data.get('å­˜å»¢ç‹€æ…‹',\
          \ '').strip()\n    station_number = station_data.get('ç«™è™Ÿ', '').strip()\n\
          \    weather_code = station_data.get('æ°£è±¡ç½²ç«™è™Ÿ', '').strip()\n    \n    if\
          \ not station_name or not category:\n        return None\n\n    # å·²å»¢æ¸¬ç«™æ¨™è¨˜è™•ç†\n\
          \    if status == \"å·²å»¢\":\n        station_name = f\"{station_name}(å·²å»¢)\"\
          \n    \n    # \U0001F3AF ä¿®å¾©å¾Œçš„è³‡æ–™é¡å‹ç¯©é¸é‚è¼¯\n    if target_data_type and target_data_type\
          \ not in [\"æœªæŒ‡å®š\", \"å¤šçµæœæŸ¥è©¢\"]:\n        if not type_matches(category, target_data_type):\n\
          \            return None\n    # \U0001F195 å°æ–¼å¤šçµæœæŸ¥è©¢ï¼Œä¸é€²è¡Œé¡å‹ç¯©é¸ï¼Œä¿ç•™æ‰€æœ‰æ¸¬ç«™\n    \n\
          \    primary_code = weather_code if category == 'é›¨é‡' and weather_code else\
          \ station_number\n    if not primary_code:\n        return None\n    \n\
          \    return {\n        \"station_name\": station_name,\n        \"station_code\"\
          : primary_code,\n        \"data_category\": category,\n        \"status\"\
          : status if status else \"ç¾å­˜\",\n        \"management_unit\": station_data.get('ç®¡ç†å–®ä½',\
          \ ''),\n        \"watershed\": station_data.get('æµåŸŸ', ''),\n        \"river\"\
          : station_data.get('æ²³å·', ''),\n        \"address\": station_data.get('åœ°å€',\
          \ ''),\n        \"county\": station_data.get('ç¸£å¸‚', ''),\n        \"data_periods\"\
          : extract_data_periods(station_data, category),\n        \"coordinates\"\
          : extract_coordinates(station_data)\n    }\n\n\ndef parse_content_fields(content):\n\
          \    \"\"\"è§£æcontentæ¬„ä½\"\"\"\n    if not content:\n        return {}\n \
          \   \n    data = {}\n    try:\n        parts = content.split(';')\n    \
          \    for part in parts:\n            if '\":\"' in part:\n             \
          \   key_part, value_part = part.split('\":\"', 1)\n                key =\
          \ key_part.replace('\"', '').replace('\\\\', '').strip()\n             \
          \   value = value_part.replace('\"', '').replace('\\\\', '').strip()\n \
          \               \n                if key and value and value != \"-\":\n\
          \                    data[key] = value\n        return data\n    except:\n\
          \        return {}\n\n\ndef extract_data_periods(station_data, data_category=None):\n\
          \    \"\"\"æå–æ¸¬ç«™çš„è³‡æ–™æ™‚é–“å€é–“\"\"\"\n    periods = {}\n    \n    if data_category\
          \ == \"é›¨é‡\":\n        time_fields = ['æ™‚é›¨é‡', 'æ—¥é›¨é‡', 'æœˆé›¨é‡']\n    elif data_category\
          \ == \"æ°´ä½æµé‡å«æ²™é‡\":\n        time_fields = ['æ™‚æ°´ä½', 'æ—¥æ°´ä½', 'æœˆæ°´ä½']\n    elif\
          \ data_category == \"åœ°ä¸‹æ°´ä½\":\n        time_fields = ['æ™‚æ°´ä½', 'æ—¥æ°´ä½', 'æœˆæ°´ä½']\
          \ \n    else:\n        time_fields = [\n            'æ™‚æ°´ä½', 'æ—¥æ°´ä½', 'æœˆæ°´ä½',\n\
          \            'æ™‚é›¨é‡', 'æ—¥é›¨é‡', 'æœˆé›¨é‡',\n            'æ™‚åœ°ä¸‹æ°´ä½', 'æ—¥åœ°ä¸‹æ°´ä½', 'æœˆåœ°ä¸‹æ°´ä½'\n\
          \        ]\n    \n    for field in time_fields:\n        if field in station_data\
          \ and station_data[field]:\n            value = station_data[field].strip()\n\
          \            if value and value != \"-\":\n                periods[field]\
          \ = value\n    \n    return periods\n\n\ndef extract_coordinates(station_data):\n\
          \    \"\"\"æå–æ¸¬ç«™åº§æ¨™è³‡è¨Š\"\"\"\n    coordinates = {}\n    x_coord = station_data.get('TWD97M2(Xåæ¨™)',\
          \ '').strip()\n    y_coord = station_data.get('TWD97M2(Yåæ¨™)', '').strip()\n\
          \    \n    if x_coord and x_coord != \"-\":\n        coordinates[\"x\"]\
          \ = x_coord\n    if y_coord and y_coord != \"-\":\n        coordinates[\"\
          y\"] = y_coord\n    \n    return coordinates\n\n\ndef build_station_url(station_code,\
          \ data_category, start_date, end_date):\n    \"\"\"çµ„å»ºAPI URL\"\"\"\n   \
          \ if not all([station_code, data_category, start_date, end_date]):\n   \
          \     return \"\"\n    \n    is_recent = is_recent_data(start_date, end_date)\n\
          \    category_map = {\n        \"é›¨é‡\": (\"RA\", \"rtRA\"),\n        \"æ°´ä½æµé‡å«æ²™é‡\"\
          : (\"LE\", \"rtLE\"), \n        \"åœ°ä¸‹æ°´ä½\": (\"GW\", \"rtGW\")\n    }\n  \
          \  \n    if data_category not in category_map:\n        return \"\"\n  \
          \  \n    hist_cat, rt_cat = category_map[data_category]\n    \n    if is_recent:\n\
          \        mobile_domain = \"HydroinfoMobile\" if data_category == \"é›¨é‡\"\
          \ else \"HydroInfoMobile\"\n        extra_params = \"&deptID=1&flow_cnt=\"\
          \ if data_category != \"é›¨é‡\" else \"\"\n        \n        return (f\"https://gweb.wra.gov.tw/{mobile_domain}/hichart?\"\
          \n                f\"stno={station_code}&category={rt_cat}&\"\n        \
          \        f\"sdate={start_date}&edate={end_date}{extra_params}&searchType=\"\
          )\n    else:\n        start_year = start_date.split('/')[0]\n        return\
          \ (f\"https://gweb.wra.gov.tw/HydroInfo/hichart?\"\n                f\"\
          stno={station_code}&category={hist_cat}&\"\n                f\"sYear={start_year}&timeType=dd&mode=0\"\
          )\n\n\ndef is_recent_data(start_date, end_date):\n    \"\"\"åˆ¤æ–·æ˜¯å¦ç‚ºè¿‘æœŸè³‡æ–™\"\"\
          \"\n    try:\n        from datetime import datetime, timedelta\n       \
          \ today = datetime.now()\n        two_years_ago = today - timedelta(days=730)\n\
          \        end = datetime.strptime(end_date, \"%Y/%m/%d\")\n        return\
          \ end >= two_years_ago\n    except:\n        return False\n\n\ndef type_matches(station_category,\
          \ target_data_type):\n    \"\"\"è³‡æ–™é¡å‹åŒ¹é…\"\"\"\n    if target_data_type in\
          \ [\"å¤šçµæœæŸ¥è©¢\"]:\n        return True \n    if station_category == target_data_type:\n\
          \        return True\n    \n    type_mapping = {\n        \"æ°´ä½æµé‡å«æ²™é‡\": [\"\
          æ°´ä½\", \"æµé‡\", \"å«æ²™é‡\", \"æ°´ä½æµé‡å«æ²™é‡\"],\n        \"é›¨é‡\": [\"é›¨é‡\", \"é™é›¨\", \"\
          é›¨æ°´\", \"é™æ°´\"],\n        \"åœ°ä¸‹æ°´ä½\": [\"åœ°ä¸‹æ°´ä½\", \"åœ°ä¸‹æ°´\", \"äº•æ°´\", \"è§€æ¸¬äº•\"]\n\
          \    }\n    \n    for standard_type, aliases in type_mapping.items():\n\
          \        if station_category == standard_type and target_data_type in aliases:\n\
          \            return True\n    \n    return False\n\n\ndef remove_duplicate_stations(stations_json_list):\n\
          \    \"\"\"å»é‡è™•ç†\"\"\"\n    if not stations_json_list:\n        return []\n\
          \    \n    seen_codes = set()\n    unique_stations = []\n    \n    for station_json\
          \ in stations_json_list:\n        try:\n            station = json.loads(station_json)\
          \ if isinstance(station_json, str) else station_json\n            code =\
          \ station.get('station_code', '')\n            \n            if code and\
          \ code not in seen_codes:\n                seen_codes.add(code)\n      \
          \          unique_stations.append(station_json)\n        except:\n     \
          \       unique_stations.append(station_json)\n    \n    return unique_stations\n\
          \n\ndef build_complete_station_data(station, api_url):\n    \"\"\"çµ„å»ºå®Œæ•´çš„æ¸¬ç«™è³‡æ–™\"\
          \"\"\n    station_data = {\n        \"station_name\": station.get(\"station_name\"\
          , \"\"),\n        \"station_code\": station.get(\"station_code\", \"\"),\n\
          \        \"data_category\": station.get(\"data_category\", \"\"),\n    \
          \    \"api_url\": api_url,\n        \"management_unit\": station.get(\"\
          management_unit\", \"\"),\n        \"watershed\": station.get(\"watershed\"\
          , \"\"),\n        \"river\": station.get(\"river\", \"\"),\n        \"address\"\
          : station.get(\"address\", \"\"),\n        \"county\": station.get(\"county\"\
          , \"\"),\n        \"status\": station.get(\"status\", \"\"),\n        \"\
          data_periods\": station.get(\"data_periods\", {}),\n        \"coordinates\"\
          : station.get(\"coordinates\", {})\n    }\n\n    location_parts = []\n \
          \   for field in [\"management_unit\", \"watershed\", \"river\", \"address\"\
          ]:\n        if station.get(field, \"\"):\n            location_parts.append(station.get(field,\
          \ \"\"))\n\n    if location_parts:\n        station_data[\"location_info\"\
          ] = \"ã€\".join(location_parts)\n    \n    return station_data\n\n\ndef analyze_failure_reason(item,\
          \ target_data_type):\n    \"\"\"åˆ†ææ¸¬ç«™ç¯©é¸å¤±æ•—åŸå› \"\"\"\n    content = item.get(\"\
          content\", \"\")\n    if not content:\n        return \"ç„¡contentå…§å®¹\"\n \
          \   \n    station_data = parse_content_fields(content)\n    if not station_data:\n\
          \        return \"contentè§£æå¤±æ•—\"\n    \n    station_name = station_data.get('ç«™å',\
          \ '').strip()\n    category = station_data.get('é¡åˆ¥', '').strip()\n    status\
          \ = station_data.get('å­˜å»¢ç‹€æ…‹', '').strip()\n    \n    if not station_name:\n\
          \        return \"ç¼ºå°‘ç«™å\"\n    if not category:\n        return \"ç¼ºå°‘é¡åˆ¥\"\n\
          \    if status == \"å·²å»¢\":\n        return \"æ¸¬ç«™å·²å»¢\"\n    if target_data_type\
          \ and not type_matches(category, target_data_type):\n        return f\"\
          è³‡æ–™é¡å‹ä¸ç¬¦({category}â‰ {target_data_type})\"\n    \n    return \"å…¶ä»–åŸå› \""
        code_language: python3
        desc: ''
        outputs:
          debug_info:
            children: null
            type: object
          queryInfo:
            children: null
            type: object
          stationsData:
            children: null
            type: array[string]
        selected: false
        title: è§£æçŸ¥è­˜æª¢ç´¢
        type: code
        variables:
        - value_selector:
          - '1750036748953'
          - output
          variable: Integration
        - value_selector:
          - '1749807861742'
          - location
          variable: location
        - value_selector:
          - '1749807861742'
          - dataType
          variable: dataType
        - value_selector:
          - '1749807861742'
          - startDate
          variable: startDate
        - value_selector:
          - '1749807861742'
          - endDate
          variable: endDate
      height: 52
      id: '1750037499341'
      position:
        x: 1509.058393061163
        y: 310
      positionAbsolute:
        x: 1509.058393061163
        y: 310
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: true
          variable_selector:
          - '1750037499341'
          - stationsData
        desc: æ•´åˆLLM
        model:
          completion_params: {}
          mode: chat
          name: gpt-4o-mini
          provider: langgenius/azure_openai/azure_openai
        prompt_template:
        - id: 44d97edd-b77a-452f-98b5-e5e59ee75fd9
          role: system
          text: "ä½ æ˜¯å°ç£æ°´æ–‡æ¸¬ç«™æ™ºèƒ½ç¯©é¸å°ˆå®¶ï¼Œå¾æä¾›çš„æ¸¬ç«™è³‡æ–™ä¸­é¸æ“‡ç¬¦åˆç”¨æˆ¶æŸ¥è©¢çš„æ¸¬ç«™ã€‚\n<CONTEXT>\nstationsData:{{#context#}}\n\
            </CONTEXT>\nã€æ ¸å¿ƒé™åˆ¶ã€‘\n- **åƒ…èƒ½å¾ stationsData ä¸­ç›´æ¥è¤‡è£½è³‡æ–™ï¼Œçµ•å°ä¸å¯è™›æ§‹ã€ä¿®æ”¹æˆ–å‰µé€ æ¸¬ç«™**\n- **è¼¸å…¥å¹¾ç­†æ¸¬ç«™è³‡æ–™ï¼Œè¼¸å‡ºæœ€å¤šå¹¾ç­†**ï¼ˆä¾‹ï¼šè¼¸å…¥1ç­†â†’æœ€å¤šè¼¸å‡º1ç­†ï¼‰\n\
            ã€åŒ¹é…è¦å‰‡ã€‘\nä¸€èˆ¬æŸ¥è©¢ : dateType = é›¨é‡/æ°´ä½æµé‡å«æ²™é‡/åœ°ä¸‹æ°´ä½\n- ä¸»è¦åŒ¹é… station_nameï¼ˆæ¸¬ç«™åç¨±ï¼‰\n\
            å€åŸŸæŸ¥è©¢ : dateType = å¤šçµæœæŸ¥è©¢\n- é™¤äº†æ¸¬ç«™åç¨±é‚„è¦åŒ¹é… address æˆ– countyæˆ–watershedæˆ–riverï¼ˆåœ°å€æˆ–ç¸£å¸‚æˆ–æµåŸŸæˆ–æ²³å·ï¼‰\n\
            åœ°é»åŒ¹é…å„ªå…ˆé †åºï¼šå®Œå…¨åŒ¹é… > åŒ…å«åŒ¹é… > ç›¸ä¼¼åŒ¹é…\n- å®Œå…¨åŒ¹é…ï¼šã€Œä¸­æ­£æ©‹ã€= ã€Œä¸­æ­£æ©‹ã€\n- åŒ…å«åŒ¹é…ï¼šã€Œä¸­æ­£æ©‹ã€åŒ…å«æ–¼ã€Œä¸­æ­£å¤§æ©‹ã€\
            \  \n- ç›¸ä¼¼åŒ¹é…ï¼šã€Œç«¹æ—å¤§æ©‹ã€vsã€Œç«¹æ—å¤§æ©‹(å·¦å²¸)ã€\nã€è¼¸å‡ºåˆ¤æ–·ã€‘\n- æ‰¾åˆ°1å€‹åŒ¹é… â†’ result_type: \"single\"\
            \n- æ‰¾åˆ°2+å€‹åŒ¹é… â†’ result_type: \"multiple\"  \n- ç„¡åŒ¹é… â†’ result_type: \"none\"\
            \n- ä¿ç•™æ‰€æœ‰åˆç†åŒ¹é…ï¼ˆå«å·²å»¢æ¸¬ç«™ï¼‰\nã€è³‡æ–™è¦æ±‚ã€‘\nå¿…å¡«ï¼šstation_name, station_code, api_url, data_category,\
            \ location_info\né¸å¡«ï¼šstatus, county, data_periods, coordinates\nâ€» data_periods\
            \ èˆ‡ coordinates éœ€ç‚º JSON å­—ä¸²æ ¼å¼\nè«‹ç›´æ¥è¤‡è£½ stationsData ä¸­çš„åŸå§‹å€¼ï¼Œè¼¸å‡ºç´” JSON çµæ§‹ã€‚"
        - id: e5e35944-1e68-4b76-b3b2-3c39e58ecd49
          role: user
          text: 'è«‹æ ¹æ“šä»¥ä¸‹ä½¿ç”¨è€…æŸ¥è©¢èˆ‡æ¸¬ç«™è³‡æ–™ï¼Œé€²è¡Œåœ°é»èˆ‡è³‡æ–™é¡åˆ¥çš„ç¯©é¸ï¼Œä¸¦è¼¸å‡ºç¬¦åˆä¸‹åˆ—çµæ§‹çš„ JSONï¼š

            ç”¨æˆ¶æŸ¥è©¢ï¼š{{#1749807861742.userQuery#}}'
        selected: false
        structured_output:
          schema:
            properties:
              result_type:
                description: ç¯©é¸çµæœé¡å‹
                enum:
                - single
                - multiple
                - none
                type: string
              selected_stations:
                description: ç¯©é¸å‡ºçš„æ¸¬ç«™åˆ—è¡¨
                items:
                  properties:
                    api_url:
                      description: APIæŸ¥è©¢ç¶²å€
                      type: string
                    coordinates:
                      description: åº§æ¨™è³‡è¨ŠJSONå­—ä¸²
                      type: string
                    county:
                      description: ç¸£å¸‚è³‡è¨Š
                      type: string
                    data_category:
                      description: è³‡æ–™é¡åˆ¥
                      type: string
                    data_periods:
                      description: è³‡æ–™æ™‚é–“ç¯„åœJSONå­—ä¸²
                      type: string
                    location_info:
                      description: ä½ç½®è³‡è¨Šæ•´åˆ
                      type: string
                    station_code:
                      description: æ¸¬ç«™ç·¨è™Ÿ
                      type: string
                    station_name:
                      description: æ¸¬ç«™åç¨±
                      type: string
                    status:
                      description: æ¸¬ç«™ç‹€æ…‹
                      type: string
                  required:
                  - station_name
                  - station_code
                  - api_url
                  - data_category
                  - location_info
                  type: object
                type: array
            required:
            - result_type
            - selected_stations
            type: object
        structured_output_enabled: true
        title: LLM
        type: llm
        variables: []
        vision:
          enabled: false
      height: 116
      id: '1750043258451'
      position:
        x: 2129.877890181342
        y: 435.3272405658025
      positionAbsolute:
        x: 2129.877890181342
        y: 435.3272405658025
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        selected: false
        template: "{% set info_greetings = [\r\n  \"å°æ°´æ»´ç‚ºæ‚¨æŸ¥è©¢åˆ°äº†\",\r\n  \"å°æ°´æ»´æˆåŠŸå–å¾—äº†\"\
          , \r\n  \"å°æ°´æ»´æ‰¾åˆ°äº†\",\r\n  \"å°æ°´æ»´æœå°‹åˆ°äº†\",\r\n  \"å°æ°´æ»´å¹«æ‚¨æº–å‚™å¥½äº†\"\r\n] %}\r\n\r\n\
          {% set info_multiple_greetings = [\r\n  \"å°æ°´æ»´æ‰¾åˆ°äº†å¤šå€‹ç›¸é—œæ¸¬ç«™\",\r\n  \"å°æ°´æ»´æœå°‹åˆ°äº†å¹¾å€‹æ¸¬ç«™\"\
          , \r\n  \"å°æ°´æ»´ç‚ºæ‚¨æ‰¾åˆ°äº†ç›¸é—œæ¸¬ç«™\",\r\n  \"å°æ°´æ»´ç™¼ç¾äº†å¤šå€‹æ¸¬ç«™é¸é …\",\r\n  \"å°æ°´æ»´å¹«æ‚¨æº–å‚™äº†æ¸¬ç«™æ¸…å–®\"\r\
          \n] %}\r\n\r\n{% set info_error_messages = [\r\n  \"å°æ°´æ»´å¾ˆæŠ±æ­‰ï¼Œæ²’æœ‰æ‰¾åˆ°ç›¸é—œæ¸¬ç«™è³‡æ–™\"\
          ,\r\n  \"å°æ°´æ»´æœå°‹å¾Œï¼Œæœªç™¼ç¾ç¬¦åˆæ¢ä»¶çš„æ¸¬ç«™\",\r\n  \"å°æ°´æ»´æŸ¥è©¢äº†è³‡æ–™åº«ï¼Œæš«ç„¡ç›¸é—œæ¸¬ç«™è³‡è¨Š\",\r\n  \"å°æ°´æ»´åŠªåŠ›æŸ¥æ‰¾ï¼Œä½†æ²’æœ‰æ‰¾åˆ°åŒ¹é…çš„æ¸¬ç«™\"\
          \r\n] %}\r\n\r\n{% if selected_stations and selected_stations|length > 0\
          \ %}\r\n  {% set stations = selected_stations %}\r\n  \r\n  {% if stations|length\
          \ == 1 %}\r\n    {% set random_greeting = info_greetings[range(0, info_greetings|length)\
          \ | random] %}\r\n    {% set station = stations[0] %}\r\n\r\n**{{ random_greeting\
          \ }}æ¸¬ç«™è§€æ¸¬è³‡æ–™ï¼š**\r\n\r\n**{{ station.station_name }}**  \r\næ¸¬ç«™ç·¨è™Ÿï¼š{{ station.station_code\
          \ }}  \r\n{%- if station.location_info %}\r\n{%- set address = station.location_info.split('ã€')[-1]\
          \ %}\r\nè¨­ç½®åœ°é»ï¼š{{ address }}  \r\n{%- endif %}\r\n[æŸ¥çœ‹è§€æ¸¬æ•¸æ“š]({{ station.api_url\
          \ }})\r\n\r\n  {% else %}\r\n    {% set random_multiple = info_multiple_greetings[range(0,\
          \ info_multiple_greetings|length) | random] %}\r\n\r\n**{{ random_multiple\
          \ }}ï¼Œè«‹é¸æ“‡æ‚¨éœ€è¦çš„æ¸¬ç«™ï¼š**\r\n\r\n{% for station in stations -%}\r\n**{{ loop.index\
          \ }}. {{ station.station_name }}**  \r\næ¸¬ç«™ç·¨è™Ÿï¼š{{ station.station_code }}\
          \  \r\n{%- if station.location_info %}\r\n{%- set address = station.location_info.split('ã€')[-1]\
          \ %}\r\nè¨­ç½®åœ°é»ï¼š{{ address }}  \r\n{%- endif %}\r\n[æŸ¥çœ‹è§€æ¸¬æ•¸æ“š]({{ station.api_url\
          \ }})\r\n\r\n{% endfor %}\r\n  {% endif %} \r\n\r\n{% if stations|length\
          \ == 10 %}\r\n---\r\n**å°æ°´æ»´æº«é¦¨æé†’ï¼š** ç³»çµ±ä¸­æœ‰ {{ stations|length }} å€‹æ¸¬ç«™è§€æ¸¬è³‡æ–™ã€‚\r\n\
          \r\næŸ¥è©¢æ›´å¤šæ¸¬ç«™è§€æ¸¬è³‡æ–™ï¼š[å‰å¾€æ°´æ–‡è³‡è¨Šç¶²](https://gweb.wra.gov.tw/Hydroinfo/?id=Index)\r\n\
          {% endif %}\r\n\r\n{% else %}\r\n  {% set random_error = info_error_messages[range(0,\
          \ info_error_messages|length) | random] %}\r\n\r\nâš ï¸ **{{ random_error }}ï¼Œè«‹ç¢ºèªæ¸¬ç«™åç¨±æˆ–å˜—è©¦å…¶ä»–é—œéµå­—ã€‚**\r\
          \n\r\n{% if validation_stats and validation_stats.original_count > 0 %}\r\
          \nå°æ°´æ»´æ ¹æ“šæ‚¨çš„é—œéµå­—æ‰¾åˆ°ä¸€äº›å¯èƒ½çš„æ–¹å‘ï¼Œä½†æ¯”å°å®˜æ–¹è³‡æ–™å¾Œï¼Œç™¼ç¾å®ƒå€‘ä¸¦éæœ‰æ•ˆçš„æ¸¬ç«™åç¨±ã€‚\r\n\r\n**å»ºè­°æ‚¨å¯ä»¥ï¼š**  \r\nâ€¢ æª¢æŸ¥è¼¸å…¥çš„åç¨±æ˜¯å¦æœ‰éŒ¯å­—\
          \  \r\nâ€¢ å˜—è©¦ä½¿ç”¨æ›´ç°¡çŸ­çš„é—œéµå­—\r\n{% endif %} \r\n{% endif %}"
        title: æ¨¡æ¿è½‰æ›
        type: template-transform
        variables:
        - value_selector:
          - '1750401071179'
          - result_type
          variable: result_type
        - value_selector:
          - '1750401071179'
          - selected_stations
          variable: selected_stations
        - value_selector:
          - '1750401071179'
          - validation_stats
          variable: validation_stats
      height: 52
      id: '1750058389563'
      position:
        x: 2726
        y: 450
      positionAbsolute:
        x: 2726
        y: 450
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: not empty
            id: d3875465-6c15-45d5-be52-15c15d8a9a7c
            value: ''
            varType: array[string]
            variable_selector:
            - '1750037499341'
            - stationsData
          id: 'true'
          logical_operator: and
        - case_id: 1f534004-da2c-4056-b3a5-86613eba9478
          conditions:
          - comparison_operator: empty
            id: ea3dd494-4d5a-4193-9640-9a44510680cb
            value: ''
            varType: array[string]
            variable_selector:
            - '1750037499341'
            - stationsData
          id: 1f534004-da2c-4056-b3a5-86613eba9478
          logical_operator: and
        desc: åˆ¤æ–·è³‡æ–™ç‹€æ…‹(å·²å»¢,é‡è¤‡,æ™‚é–“å€é–“)
        selected: false
        title: æ¢ä»¶åˆ†æ”¯
        type: if-else
      height: 200
      id: '1750063100583'
      position:
        x: 1817.9585237323186
        y: 310
      positionAbsolute:
        x: 1817.9585237323186
        y: 310
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1750130176499'
          - output
          variable: output
        selected: false
        title: çµæŸ 2
        type: end
      height: 88
      id: '1750063110498'
      position:
        x: 2422
        y: 306
      positionAbsolute:
        x: 2422
        y: 306
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: è³‡æ–™ç‹€æ…‹ä¸ç¬¦è™•ç†
        selected: false
        template: "{% if debug_info.time_filtered_stations and debug_info.time_filtered_stations|length\
          \ > 0 -%}\r\n  {%- set greetings = [\r\n    \"å°æ°´æ»´æ‰¾åˆ°æ¸¬ç«™äº†ï¼Œä½†\",\r\n    \"å°æ°´æ»´æŸ¥åˆ°æ¸¬ç«™ï¼Œä¸é\"\
          , \r\n    \"å°æ°´æ»´æœå°‹åˆ°æ¸¬ç«™ï¼Œå¯æƒœ\"\r\n  ] -%}\r\n  {%- set random_greeting = greetings[range(0,\
          \ greetings|length) | random] -%}\r\n{{ random_greeting }}\r\n\r\n  {%-\
          \ if debug_info.time_filtered_stations|length == 1 -%}\r\n**{{ debug_info.time_filtered_stations[0].station_name\
          \ }}**\r\n{%- if debug_info.time_filtered_stations[0].station_code %} (æ¸¬ç«™ç·¨è™Ÿï¼š{{\
          \ debug_info.time_filtered_stations[0].station_code }}){% endif %}\r\n\r\
          \n**æŸ¥è©¢æœŸé–“ç„¡è³‡æ–™**ï¼š{{ debug_info.query_years.start }}~{{ debug_info.query_years.end\
          \ }} å¹´\r\n\r\n**å¯¦éš›å¯ç”¨æœŸé–“**ï¼š\r\n    {%- for data_type, period_range in debug_info.time_filtered_stations[0].data_periods.items()\
          \ %}\r\n      {%- if period_range and period_range != \"-\" %}\r\n- {{ data_type\
          \ }}ï¼š{{ period_range }}\r\n      {%- endif %}\r\n    {%- endfor %}\r\n\r\
          \n**å»ºè­°**ï¼šè«‹èª¿æ•´æŸ¥è©¢æ™‚é–“ç¯„åœè‡³å¯¦éš›å¯ç”¨æœŸé–“\r\n  {%- else -%}\r\n**{{ debug_info.query_years.start\
          \ }}~{{ debug_info.query_years.end }} å¹´æœŸé–“å‡ç„¡è³‡æ–™**\r\n\r\næ‰¾åˆ° {{ debug_info.time_filtered_stations|length\
          \ }} å€‹æ¸¬ç«™ï¼Œä½†æŸ¥è©¢æ™‚é–“ç¯„åœå…§éƒ½æ²’æœ‰è§€æ¸¬è³‡æ–™ï¼š\r\n    {%- for station in debug_info.time_filtered_stations\
          \ %}\r\n\r\n**{{ loop.index }}. {{ station.station_name }}**\r\n{%- if station.station_code\
          \ %} (æ¸¬ç«™ç·¨è™Ÿï¼š{{ station.station_code }}){% endif %}\r\n\r\n**å¯¦éš›å¯ç”¨æœŸé–“**ï¼š\r\n\
          \      {%- for data_type, period_range in station.data_periods.items() %}\r\
          \n        {%- if period_range and period_range != \"-\" %}\r\n- {{ data_type\
          \ }}ï¼š{{ period_range }}\r\n        {%- endif %}\r\n      {%- endfor %}\r\
          \n    {%- endfor %}\r\n\r\n**å»ºè­°**ï¼šè«‹é¸æ“‡é©åˆçš„è³‡æ–™æœŸé–“é€²è¡ŒæŸ¥è©¢\r\n  {%- endif %}\r\n\r\
          \n{%- elif debug_info.failed_reasons -%}\r\n  {%- set error_greetings =\
          \ [\r\n    \"å°æ°´æ»´å¾ˆæŠ±æ­‰\",\r\n    \"å°æ°´æ»´æœå°‹å¾Œç™¼ç¾\",\r\n    \"å°æ°´æ»´æŸ¥è©¢çµæœ\"\r\n  ] -%}\r\
          \n  {%- set random_error = error_greetings[range(0, error_greetings|length)\
          \ | random] -%}\r\n{{ random_error }}\r\n\r\n**æ²’æœ‰æ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„æ¸¬ç«™**\r\n\r\n**æŸ¥è©¢æ¢ä»¶ï¼š**\r\
          \n- åœ°é»ï¼š{{ queryInfo.location }}\r\n- è³‡æ–™é¡å‹ï¼š{{ queryInfo.dataType }}\r\n \
          \ {%- if debug_info.query_years and debug_info.query_years.valid %}\r\n\
          - æ™‚é–“ç¯„åœï¼š{{ debug_info.query_years.start }}~{{ debug_info.query_years.end\
          \ }} å¹´\r\n  {%- endif %}\r\n\r\n**å¯èƒ½åŸå› ï¼š**\r\n  {%- if debug_info.failed_reasons.get('æ¸¬ç«™å·²å»¢',\
          \ 0) > 0 %}\r\n- æ¸¬ç«™å·²å»¢ç«™ï¼ˆæ‰¾åˆ° {{ debug_info.failed_reasons['æ¸¬ç«™å·²å»¢'] }} å€‹å·²å»¢æ¸¬ç«™ï¼‰\r\
          \n  {%- endif %}\r\n  {%- if debug_info.failed_reasons.get('è³‡æ–™é¡å‹ä¸ç¬¦', 0)\
          \ > 0 %}\r\n- è³‡æ–™é¡å‹ä¸ç¬¦åˆ\r\n  {%- endif %}\r\n  {%- if debug_info.failed_reasons.get('ç¼ºå°‘ç«™å',\
          \ 0) > 0 or debug_info.failed_reasons.get('ç¼ºå°‘é¡åˆ¥', 0) > 0 %}\r\n- æ¸¬ç«™è³‡æ–™ä¸å®Œæ•´\r\
          \n  {%- endif %}\r\n\r\n**å»ºè­°ï¼š**\r\n- æª¢æŸ¥æ¸¬ç«™åç¨±æ˜¯å¦æ­£ç¢º\r\n- å˜—è©¦ä½¿ç”¨æ›´ç²¾ç¢ºæˆ–æ›´ç°¡çŸ­çš„é—œéµå­—\r\n\
          - ç¢ºèªè³‡æ–™é¡å‹æ˜¯å¦æ­£ç¢º\r\n\r\n{%- else -%}\r\n  {%- set empty_greetings = [\r\n  \
          \  \"å°æ°´æ»´å¾ˆæŠ±æ­‰\",\r\n    \"å°æ°´æ»´æœå°‹å¾Œ\",\r\n    \"å°æ°´æ»´æŸ¥ç„¡çµæœ\"\r\n  ] -%}\r\n  {%-\
          \ set random_empty = empty_greetings[range(0, empty_greetings|length) |\
          \ random] -%}\r\n{{ random_empty }}\r\n\r\n**æ²’æœ‰æ‰¾åˆ°ç›¸é—œæ¸¬ç«™è³‡æ–™**\r\n\r\n**å»ºè­°ï¼š**è«‹æª¢æŸ¥æŸ¥è©¢æ¢ä»¶æˆ–ç¨å¾Œå†è©¦\r\
          \n{%- endif %}"
        title: æ¨¡æ¿è½‰æ› 2
        type: template-transform
        variables:
        - value_selector:
          - '1750037499341'
          - debug_info
          variable: debug_info
        - value_selector:
          - '1750037499341'
          - queryInfo
          variable: queryInfo
      height: 80
      id: '1750130176499'
      position:
        x: 2112.724287341294
        y: 327.3586323607475
      positionAbsolute:
        x: 2112.724287341294
        y: 327.3586323607475
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        author: geoinforadmin
        desc: ''
        height: 88
        selected: false
        showAuthor: true
        text: '{"root":{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{   \"name\":
          \"call_hydro_data_scope\",   \"description\": \"æŸ¥è©¢å°ç£æ°´æ–‡æ¸¬ç«™è§€æ¸¬è³‡æ–™ï¼ˆé›¨é‡ã€æ°´ä½ã€åœ°ä¸‹æ°´ä½ç­‰æ­·å²æ•¸æ“šï¼‰\",   \"parameters\":
          {     \"type\": \"object\",     \"properties\": {       \"jsonData\": {         \"type\":
          \"object\",         \"properties\": {           \"userQuery\": {             \"type\":
          \"string\",              \"description\": \"ç”¨æˆ¶åŸå§‹æŸ¥è©¢å…§å®¹\",             \"example\":
          \"2020å¹´ç«¹æ—å¤§æ©‹æ°´ä½\"           },           \"intent\": {             \"type\":
          \"array\",              \"items\": {\"type\": \"string\"},              \"description\":
          \"æ‹†åˆ†å¾Œçš„æŸ¥è©¢æ„åœ–é™£åˆ—ã€‚è¤‡åˆæŸ¥è©¢æœƒæ‹†åˆ†æˆå¤šå€‹ç¨ç«‹é …ç›®ï¼Œå–®ä¸€æŸ¥è©¢å‰‡åŒ…å«ä¸€å€‹é …ç›®\",             \"example\": [\"2020å¹´ç«¹æ—å¤§æ©‹æ°´ä½\"]           },           \"location\":
          {             \"type\": \"string\",              \"description\": \"æ¸¬ç«™åœ°é»åç¨±\",             \"example\":
          \"ç«¹æ—å¤§æ©‹\"           },           \"dataType\": {             \"type\": \"string\",              \"description\":
          \"è³‡æ–™é¡å‹ï¼šé›¨é‡ | æ°´ä½æµé‡å«æ²™é‡ | åœ°ä¸‹æ°´ä½ | æ··åˆæŸ¥è©¢\",             \"example\": \"æ°´ä½æµé‡å«æ²™é‡\"           },           \"startDate\":
          {             \"type\": \"string\",              \"description\": \"é–‹å§‹æ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY/MM/DD\",             \"example\":
          \"2020/01/01\"           },           \"endDate\": {             \"type\":
          \"string\",              \"description\": \"çµæŸæ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY/MM/DD\",              \"example\":
          \"2020/12/31\"           }         },         \"required\": [\"userQuery\",
          \"intent\", \"location\", \"dataType\", \"startDate\", \"endDate\"]       }     },     \"required\":
          [\"jsonData\"]   } }","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""}],"direction":"ltr","format":"","indent":0,"type":"root","version":1}}'
        theme: blue
        title: ''
        type: ''
        width: 240
      height: 88
      id: '1750135131960'
      position:
        x: 105.74490688559797
        y: 645.6139081303527
      positionAbsolute:
        x: 105.74490688559797
        y: 645.6139081303527
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom-note
      width: 240
    - data:
        author: geoinforadmin
        desc: ''
        height: 88
        selected: false
        showAuthor: true
        text: '{"root":{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"#
          ===== ç¯€é»1: JSONè§£æå™¨ =====","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"def
          main(jsonData=None, **kwargs) -> dict:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  \"\"\"","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  å®Œæ•´ç‰ˆ jsonData è§£æå™¨","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Args:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  jsonData: ä¾†è‡ªå‰ä¸€å€‹ç¯€é»çš„ JSON è³‡æ–™","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Returns:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  dict: åŒ…å«æ‰€æœ‰å¿…è¦æ¬„ä½çš„è§£æçµæœ","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  \"\"\"","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  # æª¢æŸ¥æ˜¯å¦æ¥æ”¶åˆ°è³‡æ–™","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  if not jsonData:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  return {","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"location\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"dataType\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"startDate\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"endDate\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"userQuery\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"intent\": [],","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"status\": \"error\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"error_msg\": \"æœªæ¥æ”¶åˆ°è³‡æ–™\"","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  }","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  try:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  # è§£æ JSON","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  if isinstance(jsonData, str):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  parsed = json.loads(jsonData)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  else:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  parsed = jsonData","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  # æå–æ‰€æœ‰å¿…è¦æ¬„ä½","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  location = parsed.get(\"location\", \"\")","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  dataType = parsed.get(\"dataType\", \"\")","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  startDate = parsed.get(\"startDate\", \"\") Â # ğŸ†• æ–°å¢","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  endDate = parsed.get(\"endDate\", \"\") Â  Â  Â # ğŸ†• æ–°å¢","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  userQuery = parsed.get(\"userQuery\", \"\")","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  # è™•ç† intent (ç¢ºä¿æ˜¯ array[string])","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  intent = parsed.get(\"intent\", [])","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  if isinstance(intent, str):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  try:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  intent = json.loads(intent) if intent.startswith(\"[\") else
          [intent]","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  except:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  intent = [intent]","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  elif not isinstance(intent, list):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  intent = []","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  return {","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"location\": location,","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"dataType\": dataType,","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"startDate\": startDate, Â  Â  Â # ğŸ†• æ–°å¢","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"endDate\": endDate, Â  Â  Â  Â  Â # ğŸ†• æ–°å¢","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"userQuery\": userQuery,","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"intent\": intent,","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"status\": \"success\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"error_msg\": \"\"","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  }","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  except json.JSONDecodeError:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  return {","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"location\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"dataType\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"startDate\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"endDate\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"userQuery\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"intent\": [],","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"status\": \"error\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"error_msg\": \"JSON æ ¼å¼éŒ¯èª¤\"","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  }","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  except Exception as e:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  return {","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"location\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"dataType\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"startDate\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"endDate\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"userQuery\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"intent\": [],","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"status\": \"error\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"error_msg\": f\"è™•ç†éŒ¯èª¤: {str(e)}\"","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  }","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1},{"type":"linebreak","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"#
          ===== é™¤éŒ¯ç‰ˆæœ¬ (ç§»é™¤ raw_input/parsed_data) =====","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"def
          main_debug(jsonData=None, **kwargs) -> dict:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  \"\"\"","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  é™¤éŒ¯ç‰ˆæœ¬ - ç°¡åŒ–çš„é™¤éŒ¯è³‡è¨Šï¼Œç§»é™¤ä¸å¿…è¦çš„æ¬„ä½","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  \"\"\"","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  if not jsonData:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  return {","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"debug_status\": \"âŒ æ²’æœ‰æ¥æ”¶åˆ° jsonData\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"location\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"dataType\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"startDate\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"endDate\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"userQuery\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"intent\": []","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  }","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  try:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  if isinstance(jsonData, str):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  parsed = json.loads(jsonData)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  else:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  parsed = jsonData","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  location = parsed.get(\"location\", \"\")","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  dataType = parsed.get(\"dataType\", \"\")","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  startDate = parsed.get(\"startDate\", \"\")","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  endDate = parsed.get(\"endDate\", \"\")","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  userQuery = parsed.get(\"userQuery\", \"\")","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  intent = parsed.get(\"intent\", [])","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  if isinstance(intent, str):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  try:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  intent = json.loads(intent) if intent.startswith(\"[\") else
          [intent]","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  except:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  intent = [intent]","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  elif not isinstance(intent, list):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  intent = []","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  return {","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"debug_status\": \"âœ… æˆåŠŸè§£ææ‰€æœ‰æ¬„ä½\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"location\": location,","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"dataType\": dataType,","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"startDate\": startDate,","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"endDate\": endDate,","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"userQuery\": userQuery,","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"intent\": intent,","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"data_count\": len([x for x in [location, dataType, startDate,
          endDate, userQuery] if x])","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  }","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  except Exception as e:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  return {","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"debug_status\": f\"âŒ éŒ¯èª¤: {str(e)}\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"location\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"dataType\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"startDate\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"endDate\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"userQuery\": \"\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"intent\": []","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  }","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1},{"type":"linebreak","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"#
          ===== ç¯€é»2: æ¸¬ç«™è™•ç†å™¨ (é…å¥—ä¿®æ”¹) =====","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"def
          main_station_processor(location=\"\", dataType=\"\", startDate=\"\", endDate=\"\",
          userQuery=\"\", intent=[], Integration=None, **kwargs):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  \"\"\"","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  æ¸¬ç«™è™•ç†å™¨ - æ¥æ”¶JSONè§£æç¯€é»çš„å®Œæ•´è¼¸å‡º","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Args:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  location: åœ°é» (å¾JSONè§£æç¯€é»)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  dataType: è³‡æ–™é¡å‹ (å¾JSONè§£æç¯€é») Â ","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  startDate: é–‹å§‹æ™‚é–“ (å¾JSONè§£æç¯€é»)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  endDate: çµæŸæ™‚é–“ (å¾JSONè§£æç¯€é»)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  userQuery: ç”¨æˆ¶æŸ¥è©¢ (å¾JSONè§£æç¯€é»ï¼Œå¯ç”¨æ–¼LLMåƒè€ƒ)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  intent: æ„åœ–é™£åˆ— (å¾JSONè§£æç¯€é»ï¼Œå¯ç”¨æ–¼LLMåƒè€ƒ)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Integration: çŸ¥è­˜æª¢ç´¢çµæœ","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Returns:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  dict: è™•ç†å¾Œçš„æ¸¬ç«™è³‡æ–™","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  \"\"\"","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  import json","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  try:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  raw_stations = extract_raw_stations(Integration)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  if not raw_stations:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  return {\"stationsData\": [], \"resultsCount\": \"0\"}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  valid_stations = []","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  debug_info = []","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  for i, item in enumerate(raw_stations):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  station_info = parse_and_validate_station(item, dataType)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  if station_info:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  valid_stations.append(station_info)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  debug_info.append(f\"æ¸¬ç«™{i+1}é€šéç¯©é¸: {station_info[''station_name'']}\")","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  else:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  # é™¤éŒ¯è³‡è¨Š","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  content = item.get(\"content\", \"\")","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  if content:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  Â  Â  station_data = parse_content_fields(content)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  Â  Â  station_name = station_data.get(''ç«™å'', '''').strip()","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  Â  Â  category = station_data.get(''é¡åˆ¥'', '''').strip()","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  Â  Â  status = station_data.get(''å­˜å»¢ç‹€æ…‹'', '''').strip()","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  Â  Â  if status == \"å·²å»¢\":","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  debug_info.append(f\"æ¸¬ç«™{i+1}è¢«ç¯©é¸: {station_name} (å·²å»¢)\")","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  Â  Â  elif not type_matches(category, dataType):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  debug_info.append(f\"æ¸¬ç«™{i+1}è¢«ç¯©é¸: {station_name} (è³‡æ–™é¡å‹ä¸åŒ¹é…:
          {category} vs {dataType})\")","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  Â  Â  else:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  debug_info.append(f\"æ¸¬ç«™{i+1}è¢«ç¯©é¸: {station_name} (å…¶ä»–åŸå› )\")","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  if not valid_stations:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  return {","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"stationsData\": debug_info,","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"resultsCount\": str(len(debug_info))","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  }","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  stations_with_urls = []","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  for station in valid_stations:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  api_url = build_station_url(","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  station.get(\"station_code\", \"\"),","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  station.get(\"data_category\", \"\"),","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  startDate, Â # âœ… ä½¿ç”¨å¾JSONè§£æä¾†çš„æ™‚é–“","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  endDate Â  Â  # âœ… ä½¿ç”¨å¾JSONè§£æä¾†çš„æ™‚é–“","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  )","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  # çµ„å»ºæœ€çµ‚çš„æ¸¬ç«™è³‡æ–™","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  station_data = {","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"station_name\": station.get(\"station_name\", \"\"),","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"station_code\": station.get(\"station_code\", \"\"),","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"data_category\": station.get(\"data_category\", \"\"),","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"api_url\": api_url,","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"management_unit\": station.get(\"management_unit\", \"\"),","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"watershed\": station.get(\"watershed\", \"\"),","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"river\": station.get(\"river\", \"\"),","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"address\": station.get(\"address\", \"\"),","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"county\": station.get(\"county\", \"\"),","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"status\": station.get(\"status\", \"\"),","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"data_periods\": station.get(\"data_periods\", {}), Â  # ä¿ç•™","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  \"coordinates\": station.get(\"coordinates\", {}) Â  Â  Â # ä¿ç•™","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  }","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  # çµ„åˆä½ç½®æè¿°","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  location_parts = []","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  if station.get(\"management_unit\", \"\"):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  location_parts.append(station.get(\"management_unit\", \"\"))","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  if station.get(\"watershed\", \"\"):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  location_parts.append(station.get(\"watershed\", \"\"))","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  if station.get(\"river\", \"\"):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  location_parts.append(station.get(\"river\", \"\"))","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  if station.get(\"address\", \"\"):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  location_parts.append(station.get(\"address\", \"\"))","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  if location_parts:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  station_data[\"location_info\"] = \"ã€\".join(location_parts)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  stations_with_urls.append(json.dumps(station_data, ensure_ascii=False))","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  # å»é‡è™•ç†","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  unique_stations = remove_duplicates(stations_with_urls)","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  return {","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"stationsData\": unique_stations,","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  Â  Â  \"resultsCount\": str(len(unique_stations))","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  }","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  except Exception as e:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  return {\"stationsData\": [], \"resultsCount\": \"0\"}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"#
          å…¶ä»–è¼”åŠ©å‡½æ•¸ä¿æŒä¸è®Š...","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"def
          extract_raw_stations(Integration):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  if not Integration:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  return []","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  if isinstance(Integration, list):","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  return Integration","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  elif isinstance(Integration, dict) and \"output\" in Integration:","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  Â  Â  return Integration[\"output\"]","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          Â  return []","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""}],"direction":"ltr","format":"","indent":0,"type":"root","version":1}}'
        theme: cyan
        title: ''
        type: ''
        width: 240
      height: 88
      id: '1750135550171'
      position:
        x: 751.8077563351446
        y: 729.2789596355822
      positionAbsolute:
        x: 751.8077563351446
        y: 729.2789596355822
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom-note
      width: 240
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: aee5df1f-a08e-4847-b61e-678fc7012aa1
            value: success
            varType: string
            variable_selector:
            - '1749807861742'
            - status
          id: 'true'
          logical_operator: and
        - case_id: e2529f5e-b60f-4aad-95f7-0c2e25bf902e
          conditions:
          - comparison_operator: contains
            id: d81cf9a5-f84d-42b5-96cf-81972b5762ee
            value: incomplete
            varType: string
            variable_selector:
            - '1749807861742'
            - status
          id: e2529f5e-b60f-4aad-95f7-0c2e25bf902e
          logical_operator: and
        desc: ''
        selected: false
        title: æ¢ä»¶åˆ†æ”¯ 2
        type: if-else
      height: 172
      id: '1750214671657'
      position:
        x: 639.8372881991074
        y: 310
      positionAbsolute:
        x: 639.8372881991074
        y: 310
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        selected: false
        template: "{% set friendly_responses = [\r\n  \"å°æ°´æ»´æƒ³å¹«æ‚¨æŸ¥è©¢è§€æ¸¬è³‡æ–™ï¼Œéœ€è¦æ‚¨å†æä¾›ä¸€äº›è³‡è¨Š\"\
          ,\r\n  \"å°æ°´æ»´å·®ä¸€é»å°±èƒ½å¹«æ‚¨æŸ¥åˆ°è§€æ¸¬è³‡æ–™äº†ï¼Œè«‹å†è£œå……ä¸€ä¸‹\",\r\n  \"å°æ°´æ»´éœ€è¦æ‚¨æä¾›æ›´å¤šè³‡è¨Šï¼Œæ‰èƒ½ç²¾æº–æŸ¥è©¢è§€æ¸¬è³‡æ–™\",\r\
          \n  \"ç‚ºäº†æ‰¾åˆ°æ­£ç¢ºçš„è§€æ¸¬è³‡æ–™ï¼Œå°æ°´æ»´éœ€è¦æ‚¨è£œå……è³‡è¨Š\"\r\n] %}\r\n{% set random_response = friendly_responses[range(0,\
          \ friendly_responses|length) | random] %}\r\n\r\n**{{ random_response }}**\
          \ \U0001F60A\r\n\r\n{% if \"location\" in incomplete_fields and \"dataType\"\
          \ in incomplete_fields and (\"startDate\" in incomplete_fields or \"endDate\"\
          \ in incomplete_fields) %}\r\nè«‹å‘Šè¨´æˆ‘ï¼š\r\n**è¦æŸ¥å“ªå€‹æ¸¬ç«™ï¼Ÿ**ï¼ˆä¾‹å¦‚ï¼šä¸‰å³½ã€ä¸­æ­£æ©‹ï¼‰\r\n**è¦æŸ¥ä»€éº¼è³‡æ–™ï¼Ÿ**ï¼ˆé›¨é‡ã€æ°´ä½ã€åœ°ä¸‹æ°´ä½ï¼‰\r\
          \n**è¦æŸ¥ä»€éº¼æ™‚é–“çš„è³‡æ–™ï¼Ÿ**ï¼ˆä¾‹å¦‚ï¼š2023å¹´ã€2023å¹´1æœˆã€æœ€è¿‘ä¸€å€‹æœˆï¼‰\r\n\r\n{% elif \"location\" in\
          \ incomplete_fields %}\r\nè«‹å‘Šè¨´æˆ‘ï¼š\r\n**è¦æŸ¥å“ªå€‹æ¸¬ç«™æˆ–åœ°å€ï¼Ÿ**\r\nä¾‹å¦‚ï¼šç«¹æ—å¤§æ©‹ã€ä¸­æ­£æ©‹\r\n\r\n\
          {% elif \"dataType\" in incomplete_fields %}\r\nè«‹å‘Šè¨´æˆ‘ï¼š\r\n\U0001F4CA **è¦æŸ¥ä»€éº¼é¡å‹çš„è³‡æ–™ï¼Ÿ**\r\
          \n- é›¨é‡è³‡æ–™\r\n- æ°´ä½è³‡æ–™\r\n- åœ°ä¸‹æ°´ä½è³‡æ–™\r\n\r\n{% elif \"startDate\" in incomplete_fields\
          \ or \"endDate\" in incomplete_fields %}\r\nè«‹å‘Šè¨´æˆ‘ï¼š\r\n**è¦æŸ¥ä»€éº¼æ™‚é–“ç¯„åœçš„è³‡æ–™ï¼Ÿ**\r\n\
          ä¾‹å¦‚ï¼š2023å¹´ã€2024å¹´3æœˆã€æœ€è¿‘åŠå¹´ã€å»å¹´å¤å¤©\r\n\r\n{% else %}\r\n{% set system_messages =\
          \ [\r\n  \"å°æ°´æ»´é‡åˆ°äº†æŠ€è¡“å•é¡Œï¼Œè«‹ç¨å¾Œå†è©¦ä¸€æ¬¡\",\r\n  \"ç³»çµ±æš«æ™‚ç„¡æ³•è™•ç†æ‚¨çš„æŸ¥è©¢ï¼Œè«‹ç¨å¾Œé‡æ–°å˜—è©¦\",\r\n  \"\
          å°æ°´æ»´çš„ç³»çµ±å‡ºç¾äº†å°ç‹€æ³ï¼Œè«‹éä¸€æœƒå…’å†å•æˆ‘\",\r\n  \"å¾ˆæŠ±æ­‰ï¼Œå°æ°´æ»´ç¾åœ¨ç„¡æ³•æŸ¥è©¢ï¼Œè«‹ç¨å¾Œå†è©¦\"\r\n] %}\r\n{% set\
          \ random_system = system_messages[range(0, system_messages|length) | random]\
          \ %}\r\n**{{ random_system }}** \r\n{% endif %}\r\n\r\n\U0001F4A1 **å¿«é€Ÿç¯„ä¾‹**ï¼š\r\
          \n- ã€Œ2023å¹´ä¸­æ­£æ©‹æ°´ä½è³‡æ–™ã€"
        title: æ¨¡æ¿è½‰æ› 3
        type: template-transform
        variables:
        - value_selector:
          - '1749807861742'
          - incomplete_fields
          variable: incomplete_fields
        - value_selector:
          - '1749807861742'
          - error_msg
          variable: error_msg
      height: 52
      id: '1750214858474'
      position:
        x: 1074
        y: 562
      positionAbsolute:
        x: 1074
        y: 562
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1750214858474'
          - output
          variable: output
        selected: false
        title: çµæŸ 3
        type: end
      height: 88
      id: '1750214871930'
      position:
        x: 1383.3294012273452
        y: 562
      positionAbsolute:
        x: 1383.3294012273452
        y: 562
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        author: geoinforadmin
        desc: ''
        height: 88
        selected: false
        showAuthor: true
        text: '{"root":{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"ä½ æ˜¯å°ç£æ°´æ–‡æ¸¬ç«™æ™ºèƒ½ç¯©é¸å°ˆå®¶ï¼Œå¾æä¾›çš„æ¸¬ç«™è³‡æ–™ä¸­é¸æ“‡ç¬¦åˆç”¨æˆ¶æŸ¥è©¢çš„æ¸¬ç«™ã€‚","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"ã€æ ¸å¿ƒé™åˆ¶ã€‘","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          **åƒ…èƒ½å¾ stationsData ä¸­ç›´æ¥è¤‡è£½è³‡æ–™ï¼Œçµ•å°ä¸å¯è™›æ§‹ã€ä¿®æ”¹æˆ–å‰µé€ æ¸¬ç«™**","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          **è¼¸å…¥å¹¾ç­†æ¸¬ç«™è³‡æ–™ï¼Œè¼¸å‡ºæœ€å¤šå¹¾ç­†**ï¼ˆä¾‹ï¼šè¼¸å…¥1ç­†â†’æœ€å¤šè¼¸å‡º1ç­†ï¼‰","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"ã€åŒ¹é…è¦å‰‡ã€‘","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"åœ°é»åŒ¹é…å„ªå…ˆé †åºï¼šå®Œå…¨åŒ¹é…
          > åŒ…å«åŒ¹é… > ç›¸ä¼¼åŒ¹é…","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          å®Œå…¨åŒ¹é…ï¼šã€Œä¸­æ­£æ©‹ã€= ã€Œä¸­æ­£æ©‹ã€","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          åŒ…å«åŒ¹é…ï¼šã€Œä¸­æ­£æ©‹ã€åŒ…å«æ–¼ã€Œä¸­æ­£å¤§æ©‹ã€  ","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          ç›¸ä¼¼åŒ¹é…ï¼šã€Œç«¹æ—å¤§æ©‹ã€vsã€Œç«¹æ—å¤§æ©‹(å·¦å²¸)ã€","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"ã€è¼¸å‡ºåˆ¤æ–·ã€‘","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          æ‰¾åˆ°1å€‹åŒ¹é… â†’ result_type: \"single\"","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          æ‰¾åˆ°2+å€‹åŒ¹é… â†’ result_type: \"multiple\"  ","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          ç„¡åŒ¹é… â†’ result_type: \"none\"","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          ä¿ç•™æ‰€æœ‰åˆç†åŒ¹é…ï¼ˆå«å·²å»¢æ¸¬ç«™ï¼‰","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"ã€è³‡æ–™è¦æ±‚ã€‘","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"å¿…å¡«ï¼šstation_name,
          station_code, api_url, data_category, location_info","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"é¸å¡«ï¼šstatus,
          county, data_periods, coordinates","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"â€»
          data_periods èˆ‡ coordinates éœ€ç‚º JSON å­—ä¸²æ ¼å¼","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"è«‹ç›´æ¥è¤‡è£½
          stationsData ä¸­çš„åŸå§‹å€¼ï¼Œè¼¸å‡ºç´” JSON çµæ§‹ã€‚","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""}],"direction":"ltr","format":"","indent":0,"type":"root","version":1}}'
        theme: blue
        title: ''
        type: ''
        width: 240
      height: 88
      id: '1750384535860'
      position:
        x: 2637.33924742608
        y: 589.849736819977
      positionAbsolute:
        x: 2637.33924742608
        y: 589.849736819977
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom-note
      width: 240
    - data:
        code: "import json\n\ndef main(llm_output, stationsData):\n    try:\n    \
          \    # 1. å»ºç«‹ç™½åå–®ï¼š(ç«™è™Ÿ, ç«™å) -> å®Œæ•´è³‡æ–™\n        whitelist = {}\n        for item\
          \ in stationsData:\n            data = json.loads(item) if isinstance(item,\
          \ str) else item\n            code = data.get(\"station_code\", \"\").strip()\n\
          \            name = data.get(\"station_name\", \"\").strip()\n         \
          \   \n            if code and name:  # åªè¦æœ‰ç«™è™Ÿå’Œç«™åå°±åŠ å…¥ç™½åå–®\n                whitelist[(code,\
          \ name)] = data\n        \n        # 2. è§£æ LLM è¼¸å‡º\n        if isinstance(llm_output,\
          \ str):\n            llm_data = json.loads(llm_output)\n        else:\n\
          \            llm_data = llm_output\n        \n        # 3. ç¯©é¸ï¼šåªä¿ç•™ç™½åå–®å…§çš„æ¸¬ç«™ï¼ˆåŠ å…¥å»é‡ï¼‰\n\
          \        valid_stations = []\n        seen = set()  # è¨˜éŒ„å·²è™•ç†çš„æ¸¬ç«™\n       \
          \ \n        for station in llm_data.get(\"selected_stations\", []):\n  \
          \          code = station.get(\"station_code\", \"\").strip()\n        \
          \    name = station.get(\"station_name\", \"\").strip()\n            \n\
          \            key = (code, name)\n            if key in whitelist and key\
          \ not in seen:\n                # è¼¸å‡ºç™½åå–®çš„å®Œæ•´è³‡æ–™ï¼ˆä¸æ˜¯ LLM çš„ï¼‰\n               \
          \ valid_stations.append(whitelist[key])\n                seen.add(key) \
          \ # æ¨™è¨˜ç‚ºå·²è™•ç†\n        \n        # 4. æ±ºå®šçµæœé¡å‹\n        if len(valid_stations)\
          \ == 0:\n            result_type = \"none\"\n        elif len(valid_stations)\
          \ == 1:\n            result_type = \"single\"\n        else:\n         \
          \   result_type = \"multiple\"\n        \n        return {\n           \
          \ \"result_type\": result_type,\n            \"selected_stations\": valid_stations,\n\
          \            \"validation_stats\": {\n                \"original_count\"\
          : len(llm_data.get(\"selected_stations\", [])),\n                \"valid_count\"\
          : len(valid_stations),\n                \"whitelist_size\": len(whitelist)\n\
          \            }\n        }\n        \n    except:\n        # ä»»ä½•éŒ¯èª¤éƒ½å›å‚³ç©ºçµæœ\n\
          \        return {\n            \"result_type\": \"none\",\n            \"\
          selected_stations\": [],\n            \"validation_stats\": {\n        \
          \        \"original_count\": 0,\n                \"valid_count\": 0,\n \
          \               \"whitelist_size\": 0\n            }\n        }"
        code_language: python3
        desc: å»ºç«‹ç™½åå–®é˜²æ­¢LLMå¹»è¦º
        outputs:
          result_type:
            children: null
            type: string
          selected_stations:
            children: null
            type: array[object]
          validation_stats:
            children: null
            type: object
        selected: false
        title: ä»£ç¢¼åŸ·è¡Œ 3
        type: code
        variables:
        - value_selector:
          - '1750043258451'
          - structured_output
          variable: llm_output
        - value_selector:
          - '1750037499341'
          - stationsData
          variable: stationsData
      height: 80
      id: '1750401071179'
      position:
        x: 2422
        y: 450
      positionAbsolute:
        x: 2422
        y: 450
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        author: geoinforadmin
        desc: ''
        height: 88
        selected: false
        showAuthor: true
        text: '{"root":{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%
          set greetings = [","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          \"å°æ°´æ»´æŸ¥åˆ°æ¸¬ç«™\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          \"å°æ°´æ»´æ‰¾åˆ°æ¸¬ç«™\", ","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          \"å°æ°´æ»´æœå°‹åˆ°æ¸¬ç«™\",","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          \"å°æ°´æ»´ç™¼ç¾æ¸¬ç«™\"","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"]
          -%}","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%
          set random_greeting = greetings[range(0, greetings|length) | random] -%}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{{
          random_greeting }}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          if debug_info.time_filtered_stations %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          {%- if debug_info.time_filtered_stations|length == 1 %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"æ¸¬ç«™åç¨±ï¼š{{
          debug_info.time_filtered_stations[0].station_name }}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          if debug_info.time_filtered_stations[0].station_code %} ({{ debug_info.time_filtered_stations[0].station_code
          }}){% endif %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"æŸ¥è©¢çµæœï¼š{{
          debug_info.query_years.start }} å¹´æœŸé–“æ²’æœ‰è§€æ¸¬è³‡æ–™","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"å¯¦éš›è³‡æ–™æœŸé–“ï¼š","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          for data_type, period_range in debug_info.time_filtered_stations[0].data_periods.items()
          -%}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          if period_range and period_range != \"-\" %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{{
          data_type }}ï¼š{{ period_range }}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          endif -%}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          endfor %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"å»ºè­°æ–¹æ¡ˆï¼šè«‹èª¿æ•´æŸ¥è©¢æ™‚é–“ç¯„åœ","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          {%- else %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"æ‰¾åˆ°
          {{ debug_info.time_filtered_stations|length }} å€‹æ¸¬ç«™","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"æŸ¥è©¢çµæœï¼š{{
          debug_info.query_years.start }} å¹´æœŸé–“å‡ç„¡è§€æ¸¬è³‡æ–™","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"æ¸¬ç«™æ¸…å–®ï¼š","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          for station in debug_info.time_filtered_stations %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{{
          loop.index }}. {{ station.station_name }}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          if station.station_code %} ({{ station.station_code }}){% endif %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          for data_type, period_range in station.data_periods.items() -%}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          if period_range and period_range != \"-\" %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{{
          data_type }}ï¼š{{ period_range }}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          endif -%}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          endfor %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          if not loop.last %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%
          endif -%}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          endfor %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"å»ºè­°æ–¹æ¡ˆï¼šè«‹é¸æ“‡é©åˆçš„è³‡æ–™æœŸé–“é€²è¡ŒæŸ¥è©¢","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"Â 
          {%- endif -%}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          elif debug_info.failed_reasons %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"æ²’æœ‰æ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„æ¸¬ç«™","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"æŸ¥è©¢æ¢ä»¶ï¼š","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"â€¢
          åœ°é»ï¼š{{ queryInfo.location }}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"â€¢
          è³‡æ–™é¡å‹ï¼š{{ queryInfo.dataType }}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"å»ºè­°æ–¹æ¡ˆï¼šè«‹ç¢ºèªæ¸¬ç«™åç¨±æ˜¯å¦æ­£ç¢º","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          else %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"å¾ˆæŠ±æ­‰ï¼Œæ²’æœ‰æ‰¾åˆ°ç›¸é—œæ¸¬ç«™è³‡æ–™","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"type":"linebreak","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"å»ºè­°ï¼šè«‹æª¢æŸ¥æŸ¥è©¢æ¢ä»¶æˆ–ç¨å¾Œå†è©¦","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{%-
          endif %}","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""}],"direction":"ltr","format":"","indent":0,"type":"root","version":1}}'
        theme: blue
        title: ''
        type: ''
        width: 240
      height: 88
      id: '1762241118483'
      position:
        x: 2142.1614260950028
        y: 123.4462088643927
      positionAbsolute:
        x: 2142.1614260950028
        y: 123.4462088643927
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom-note
      width: 240
    viewport:
      x: -26.034620155629796
      y: 19.913473580851417
      zoom: 0.5192659266237483
  rag_pipeline_variables: []
