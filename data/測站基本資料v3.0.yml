app:
  description: ''
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: æ¸¬ç«™åŸºæœ¬è³‡æ–™v3.0
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/siliconflow:0.0.27@3c4e37fef7455da28d36d559dde85201fc0b4f1819b80cd24eba56da15a711f9
    version: null
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/ollama:0.0.8@22213ae036605d41ea73bdd16908e03de1b9d5ab4656a49b8fb0343723f4cb4a
    version: null
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/azure_openai:0.0.30@c60f0c8612961bb634b9209703ed91fc752713b14399a1522a72320b46ef6185
    version: null
kind: app
version: 0.4.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInLoop: false
        sourceType: start
        targetType: code
      id: 1749455329717-source-1749456115056-target
      selected: false
      source: '1749455329717'
      sourceHandle: source
      target: '1749456115056'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: end
      id: 1749456115056-fail-branch-1749721121508-target
      source: '1749456115056'
      sourceHandle: fail-branch
      target: '1749721121508'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1749722175647-source-1749722223032-target
      source: '1749722175647'
      sourceHandle: source
      target: '1749722223032'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: template-transform
        targetType: end
      id: 1749722290058-source-1749722325395-target
      source: '1749722290058'
      sourceHandle: source
      target: '1749722325395'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: if-else
      id: 1749456115056-source-1749723660697-target
      source: '1749456115056'
      sourceHandle: source
      target: '1749723660697'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: iteration
      id: 1749723660697-3bfecbbd-e017-475e-becb-6140c55db596-1749722091423-target
      source: '1749723660697'
      sourceHandle: 3bfecbbd-e017-475e-becb-6140c55db596
      target: '1749722091423'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: knowledge-retrieval
      id: 1749723660697-true-1749723712811-target
      source: '1749723660697'
      sourceHandle: 'true'
      target: '1749723712811'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: knowledge-retrieval
        targetType: variable-aggregator
      id: 1749723712811-source-1749723734934-target
      source: '1749723712811'
      sourceHandle: source
      target: '1749723734934'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: iteration
        targetType: variable-aggregator
      id: 1749722091423-source-1749723734934-target
      source: '1749722091423'
      sourceHandle: source
      target: '1749723734934'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: variable-aggregator
        targetType: code
      id: 1749723734934-source-1749722175647-target
      selected: false
      source: '1749723734934'
      sourceHandle: source
      target: '1749722175647'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: template-transform
      id: 1749723660697-a603ccde-7469-4a4e-866e-d233c4a15c56-1750300475652-target
      source: '1749723660697'
      sourceHandle: a603ccde-7469-4a4e-866e-d233c4a15c56
      target: '1750300475652'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: template-transform
        targetType: end
      id: 1750300475652-source-1750300953338-target
      source: '1750300475652'
      sourceHandle: source
      target: '1750300953338'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1749722223032-source-1750412940660-target
      selected: false
      source: '1749722223032'
      sourceHandle: source
      target: '1750412940660'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: template-transform
      id: 1750412940660-source-1749722290058-target
      source: '1750412940660'
      sourceHandle: source
      target: '1749722290058'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1749722091423'
        sourceType: iteration-start
        targetType: knowledge-retrieval
      id: 1749722091423start-source-1752140064990-target
      source: 1749722091423start
      sourceHandle: source
      target: '1752140064990'
      targetHandle: target
      type: custom
      zIndex: 1002
    nodes:
    - data:
        desc: ''
        selected: false
        title: é–‹å§‹
        type: start
        variables:
        - label: location
          max_length: 256
          options: []
          required: true
          type: text-input
          variable: location
        - label: dataType
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: dataType
        - label: userQuery
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: userQuery
        - label: searchQueries
          max_length: 256
          options: []
          required: false
          type: paragraph
          variable: searchQueries
      height: 166
      id: '1749455329717'
      position:
        x: -114.73599272962605
        y: 294.61001596557276
      positionAbsolute:
        x: -114.73599272962605
        y: 294.61001596557276
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "from typing import Any, Dict, List, Union\nimport json\nimport re\n\
          \ndef is_valid_value(v: Any) -> bool:\n    \"\"\"æª¢æŸ¥å€¼æ˜¯å¦æœ‰æ•ˆï¼ˆéç©ºã€éNoneã€éç©ºå­—ä¸²ï¼‰\"\
          \"\"\n    if v is None:\n        return False\n    if isinstance(v, str)\
          \ and not v.strip():\n        return False\n    if isinstance(v, (list,\
          \ dict)) and len(v) == 0:\n        return False\n    return True\n\ndef\
          \ parse_searchQueries(searchQueries: Union[str, List[str], None]) -> List[str]:\n\
          \    \"\"\"è§£æ searchQueries ç‚º list[str]ï¼Œç§»é™¤å¤šé¤˜è·³è„«å­—å…ƒèˆ‡ç©ºç™½\"\"\"\n    searchQueries_list:\
          \ List[str] = []\n    \n    if searchQueries is None:\n        return []\n\
          \    \n    if isinstance(searchQueries, list):\n        return [str(x).strip()\
          \ for x in searchQueries if str(x).strip()]\n    \n    if isinstance(searchQueries,\
          \ str):\n        cleaned = searchQueries.strip()\n        # å˜—è©¦è™•ç†éåº¦è·³è„«çš„ JSON\
          \ å­—ä¸²ï¼Œä¾‹å¦‚ [\\\\\\\"ä¸­æ­£æ©‹æ°´ä½\\\\\\\"]\n        if cleaned.startswith('[\"') and\
          \ '\\\\\"' in cleaned:\n            cleaned = re.sub(r'\\\\(.)', r'\\1',\
          \ cleaned)\n        \n        try:\n            parsed = json.loads(cleaned)\n\
          \            if isinstance(parsed, list):\n                return [str(x).strip()\
          \ for x in parsed if str(x).strip()]\n            else:\n              \
          \  return [str(parsed).strip()]\n        except Exception:\n           \
          \ return [cleaned]\n    \n    return [str(searchQueries).strip()]\n\ndef\
          \ normalize_datatype(dataType: str) -> str:\n    \"\"\"å°‡ç”¨æˆ¶è¼¸å…¥çš„è³‡æ–™é¡å‹æ¨™æº–åŒ–ç‚ºçŸ¥è­˜æª¢ç´¢ç”¨çš„å®Œæ•´åç¨±\"\
          \"\"\n    if not dataType or not dataType.strip():\n        return dataType\n\
          \    \n    dataType_lower = dataType.lower().strip()\n    \n    # \U0001F3AF\
          \ ä¿®æ­£ï¼šæŠŠæ›´å…·é«”çš„é—œéµå­—æ”¾å‰é¢ï¼Œé¿å…æ­§ç¾©\n    if any(keyword in dataType_lower for keyword\
          \ in [\"åœ°ä¸‹æ°´\", \"äº•\", \"åœ°ä¸‹æ°´ä½\"]):\n        return \"åœ°ä¸‹æ°´ä½\"\n    elif any(keyword\
          \ in dataType_lower for keyword in [\"é›¨é‡\", \"é™é›¨\", \"é›¨æ°´\"]):\n        return\
          \ \"é›¨é‡\"  \n    elif any(keyword in dataType_lower for keyword in [\"æ°´ä½\"\
          , \"æµé‡\", \"å«æ²™é‡\", \"æ²³å·\"]):\n        return \"æ°´ä½æµé‡å«æ²™é‡\"\n    \n    # å¦‚æœæ²’æœ‰åŒ¹é…åˆ°ï¼Œä¿æŒåŸå€¼\n\
          \    return dataType\n\ndef is_multi_query_semantic(text: str) -> bool:\n\
          \    \"\"\"\U0001F195 èªç¾©æª¢æ¸¬ - æª¢æ¸¬æ˜¯å¦ç‚ºå¤šçµæœæŸ¥è©¢\"\"\"\n    if not text:\n      \
          \  return False\n    \n    text_lower = text.lower().strip()\n    \n   \
          \ # \U0001F3AF ç¯„åœæŸ¥è©¢è©æª¢æ¸¬\n    range_triggers = any(word in text_lower for\
          \ word in [\"å“ªäº›\", \"é™„è¿‘\", \"æ‰€æœ‰\", \"æµåŸŸ\", \"æœ‰ä»€éº¼\", \"åŒ…å«å“ªäº›\", \"å«æœ‰å“ªäº›\"])\n\
          \    \n    # \U0001F3AF å€åŸŸæ€§åœ°ç†æŸ¥è©¢æª¢æ¸¬ï¼ˆç²¾ç¢ºåŒ¹é…ï¼‰\n    regional_patterns = [\n   \
          \     r'.+æœ‰.+[æ¸¬é‡]ç«™[å—ï¼Ÿ]?',     # XXæœ‰XXæ¸¬ç«™å—\n        r'.+æ˜¯å¦æœ‰.+[æ¸¬é‡]ç«™',     \
          \   # XXæ˜¯å¦æœ‰XXæ¸¬ç«™\n        r'.+åŒ…å«.+[æ¸¬é‡]ç«™',          # XXåŒ…å«XXæ¸¬ç«™\n        r'.+è¨­æœ‰.+[æ¸¬é‡]ç«™[å—ï¼Ÿ]?',\
          \   # XXè¨­æœ‰XXæ¸¬ç«™å—\n        r'.+å­˜åœ¨.+[æ¸¬é‡]ç«™[å—ï¼Ÿ]?'    # XXå­˜åœ¨XXæ¸¬ç«™å—\n    ]\n   \
          \ regional_triggers = any(re.search(pattern, text_lower) for pattern in\
          \ regional_patterns)\n    \n    # \U0001F3AF å¤šè³‡æ–™é¡å‹æª¢æ¸¬\n    multi_type_triggers\
          \ = any(word in text_lower for word in [\"å’Œ\", \"èˆ‡\", \"åŠ\", \"æ¯”è¼ƒ\", \"\
          å°æ¯”\", \"éƒ½\", \"åˆ†åˆ¥\", \"ä»¥åŠ\"])\n    \n    return range_triggers or regional_triggers\
          \ or multi_type_triggers\n\ndef main(\n    location: str = \"\",\n    dataType:\
          \ str = \"\",\n    userQuery: str = \"\",\n    searchQueries: Union[str,\
          \ List[str], None] = None,\n    **kwargs,\n) -> Dict[str, Any]:\n    \"\"\
          \"æ•´åˆå››å€‹æ¬„ä½ï¼Œé˜²æ­¢ searchQueries å•é¡Œä¸¦åˆ¤æ–·æ˜¯å¦å¤šçµæœæŸ¥è©¢\"\"\"\n    \n    # 1. è§£æ searchQueries\n\
          \    searchQueries_list = parse_searchQueries(searchQueries)\n    \n   \
          \ # \U0001F3AF é—œéµä¿®æ­£ï¼šå¦‚æœ searchQueries ç‚ºç©ºï¼Œä½¿ç”¨åŸå§‹æŸ¥è©¢\n    if not searchQueries_list\
          \ and userQuery.strip():\n        searchQueries_list = [userQuery.strip()]\n\
          \    \n    # \U0001F195 èªç¾©æª¢æ¸¬å„ªå…ˆè™•ç†ï¼ˆåœ¨æ‰€æœ‰é‚è¼¯ä¹‹å‰ï¼‰\n    all_text = \" \".join([userQuery]\
          \ + searchQueries_list).strip()\n    if is_multi_query_semantic(all_text):\n\
          \        final_dataType = \"å¤šçµæœæŸ¥è©¢\"\n    elif dataType.strip() == \"å¤šçµæœæŸ¥è©¢\"\
          :\n        final_dataType = \"å¤šçµæœæŸ¥è©¢\"\n    else:\n        # 2. å…ˆæ¨™æº–åŒ– dataType\n\
          \        normalized_dataType = normalize_datatype(dataType)\n        \n\
          \        # 3. æ ¹æ“š searchQueries å…§å®¹æª¢æ¸¬è³‡æ–™é¡å‹\n        valid_types = {\n     \
          \       \"é›¨é‡\": [\"é›¨é‡\", \"é™é›¨\", \"é›¨æ°´\"],\n            \"æ°´ä½æµé‡å«æ²™é‡\": [\"\
          æ°´ä½\", \"æµé‡\", \"å«æ²™é‡\", \"æ²³å·\"],\n            \"åœ°ä¸‹æ°´ä½\": [\"åœ°ä¸‹æ°´\", \"äº•\",\
          \ \"åœ°ä¸‹æ°´ä½\", \"è§€æ¸¬äº•\"],\n        }\n        \n        detected_types = set()\n\
          \        for item in searchQueries_list:\n            lowered = item.lower()\n\
          \            for dtype, keywords in valid_types.items():\n             \
          \   if any(k in lowered for k in keywords):\n                    detected_types.add(dtype)\n\
          \        \n        # 4. æ±ºå®šæœ€çµ‚è³‡æ–™é¡å‹\n        if len(searchQueries_list) > 1\
          \ and len(detected_types) > 1:\n            final_dataType = \"å¤šçµæœæŸ¥è©¢\"\n\
          \        elif len(detected_types) == 1:\n            # ä½¿ç”¨æª¢æ¸¬åˆ°çš„æ¨™æº–åŒ–é¡å‹\n   \
          \         final_dataType = list(detected_types)[0]\n        else:\n    \
          \        # ä½¿ç”¨æ¨™æº–åŒ–å¾Œçš„ dataType\n            final_dataType = normalized_dataType\n\
          \    \n    # 5. æª¢æŸ¥å¿…è¦æ¬„ä½ï¼ˆåŸºæœ¬è³‡æ–™æŸ¥è©¢ï¼šlocation å’Œ dataTypeï¼‰\n    missing = [\n  \
          \      k for k, v in {\n            \"location\": location,\n          \
          \  \"dataType\": final_dataType,\n        }.items() \n        if not is_valid_value(v)\n\
          \    ]\n    \n    status = \"success\" if not missing else \"incomplete\"\
          \n    \n    # 6. ä¿æŒåŸå§‹è¼¸å‡ºæ ¼å¼\n    return {\n        \"location\": location,\n\
          \        \"dataType\": final_dataType,\n        \"userQuery\": userQuery,\n\
          \        \"searchQueries\": searchQueries_list,\n        \"status\": status,\n\
          \        \"missing_fields\": missing,\n    }"
        code_language: python3
        desc: ''
        error_strategy: fail-branch
        outputs:
          dataType:
            children: null
            type: string
          location:
            children: null
            type: string
          missing_fields:
            children: null
            type: array[string]
          searchQueries:
            children: null
            type: array[string]
          status:
            children: null
            type: string
          userQuery:
            children: null
            type: string
        selected: false
        title: ä»£ç¢¼åŸ·è¡Œ
        type: code
        variables:
        - value_selector:
          - '1749455329717'
          - location
          variable: location
        - value_selector:
          - '1749455329717'
          - dataType
          variable: dataType
        - value_selector:
          - '1749455329717'
          - userQuery
          variable: userQuery
        - value_selector:
          - '1749455329717'
          - searchQueries
          variable: searchQueries
      height: 88
      id: '1749456115056'
      position:
        x: 275.4163838951512
        y: 355.49102878041543
      positionAbsolute:
        x: 275.4163838951512
        y: 355.49102878041543
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1749456115056'
          - error_message
          variable: error_message
        selected: false
        title: çµæŸ
        type: end
      height: 88
      id: '1749721121508'
      position:
        x: 638
        y: 376
      positionAbsolute:
        x: 638
        y: 376
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        error_handle_mode: terminated
        height: 212
        is_parallel: true
        iterator_input_type: array[string]
        iterator_selector:
        - '1749456115056'
        - searchQueries
        output_selector:
        - '1752140064990'
        - result
        output_type: array[object]
        parallel_nums: 10
        selected: false
        start_node_id: 1749722091423start
        title: è¿­ä»£
        type: iteration
        width: 508
      height: 212
      id: '1749722091423'
      position:
        x: 943.1486983549971
        y: 633.733406110011
      positionAbsolute:
        x: 943.1486983549971
        y: 633.733406110011
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 508
      zIndex: 1
    - data:
        desc: ''
        isInIteration: true
        selected: false
        title: ''
        type: iteration-start
      draggable: false
      height: 48
      id: 1749722091423start
      parentId: '1749722091423'
      position:
        x: 60
        y: 82
      positionAbsolute:
        x: 1003.1486983549971
        y: 715.733406110011
      selectable: false
      sourcePosition: right
      targetPosition: left
      type: custom-iteration-start
      width: 44
      zIndex: 1002
    - data:
        code: "from typing import Any, Dict, List, Union\nimport json\n\n# å¸¸æ•¸å®šç¾©\n\
          TYPE_MAPPING = {\n    \"æ°´ä½æµé‡å«æ²™é‡\": [\"æ°´ä½\", \"æµé‡\", \"å«æ²™é‡\", \"æ°´ä½æµé‡å«æ²™é‡\"\
          ],\n    \"é›¨é‡\": [\"é›¨é‡\", \"é™é›¨\", \"é›¨æ°´\", \"é™æ°´\"],\n    \"åœ°ä¸‹æ°´ä½\": [\"åœ°ä¸‹æ°´ä½\"\
          , \"åœ°ä¸‹æ°´\", \"äº•æ°´\", \"è§€æ¸¬äº•\"]\n}\n\ndef is_valid_value(v: Any) -> bool:\n\
          \    if v is None:\n        return False\n    if isinstance(v, str) and\
          \ not v.strip():\n        return False\n    if isinstance(v, (list, dict))\
          \ and len(v) == 0:\n        return False\n    return True\n\ndef main(location=\"\
          \", dataType=\"\", Integration=None, **kwargs) -> Dict[str, Any]:\n    \"\
          \"\"\n    å¢å¼·ç‰ˆæ¸¬ç«™åŸºæœ¬è³‡æ–™è™•ç† - ç„¡æ™‚é–“é™åˆ¶ç‰ˆæœ¬\n    é‡é»ï¼šæ¸¬ç«™åç¨±ã€æ¸¬ç«™ä»£è™Ÿã€æ°´æ–‡ç¶²URLï¼ŒåŒ…å«å·²å»¢æ¸¬ç«™\n    \"\"\
          \"\n    try:\n        raw_stations = extract_raw_stations(Integration)\n\
          \        if not raw_stations:\n            return empty_result(location,\
          \ dataType)\n        \n        valid_stations = []\n        failed_reasons\
          \ = {}\n\n        for item in raw_stations:\n            station_info =\
          \ parse_and_validate_station(item, dataType)\n            if station_info:\n\
          \                valid_stations.append(station_info)\n            else:\n\
          \                fail_reason = analyze_failure_reason(item, dataType)\n\
          \                failed_reasons[fail_reason] = failed_reasons.get(fail_reason,\
          \ 0) + 1\n\n        stations_with_urls = []\n        if valid_stations:\n\
          \            for station in valid_stations:\n                api_url = build_profile_url(\n\
          \                    station.get(\"station_code\", \"\"),\n            \
          \        station.get(\"data_category\", \"\")\n                )\n     \
          \           station_data = build_complete_station_profile(station, api_url)\n\
          \                stations_with_urls.append(json.dumps(station_data, ensure_ascii=False))\n\
          \            unique_stations = remove_duplicate_stations(stations_with_urls)\n\
          \        else:\n            unique_stations = []\n\n        result_type\
          \ = \"success\" if unique_stations else \"no_match\"\n\n        return {\n\
          \            \"stationsData\": unique_stations,\n            \"queryInfo\"\
          : {\n                \"location\": location,\n                \"dataType\"\
          : dataType,\n                \"foundStations\": len(unique_stations),\n\
          \                \"stationNames\": [json.loads(s).get(\"station_name\",\
          \ \"\") for s in unique_stations[:5]],\n                \"result_type\"\
          : result_type\n            },\n            \"debug_info\": {\n         \
          \       \"raw_count\": len(raw_stations),\n                \"processed_stations\"\
          : [s.get(\"station_name\", \"\") for s in valid_stations],\n           \
          \     \"failed_reasons\": failed_reasons\n            }\n        }\n   \
          \ except Exception as e:\n        return error_result(location, dataType,\
          \ str(e))\n\n\ndef extract_raw_stations(Integration) -> List[Dict[str, Any]]:\n\
          \    \"\"\"æå–åŸå§‹æ¸¬ç«™è³‡æ–™ - ä¿®æ­£äºŒç¶­é™£åˆ—å•é¡Œ\"\"\"\n    if not Integration:\n        return\
          \ []\n    \n    if isinstance(Integration, dict) and \"output\" in Integration:\n\
          \        Integration = Integration[\"output\"]\n    \n    # è™•ç†é™£åˆ—æƒ…æ³\n   \
          \ if isinstance(Integration, list):\n        # å¦‚æœæ˜¯äºŒç¶­é™£åˆ—ï¼Œæ”¤å¹³å®ƒ\n        if Integration\
          \ and isinstance(Integration[0], list):\n            return Integration[0]\
          \  # å–ç¬¬ä¸€å±¤çš„å…§å®¹\n        return Integration\n    \n    return []\n\n\ndef parse_and_validate_station(item:\
          \ Dict[str, Any], target_data_type: str) -> Union[Dict[str, Any], None]:\n\
          \    if not isinstance(item, dict):\n        return None\n    content =\
          \ item.get(\"content\", \"\")\n    if not content:\n        return None\n\
          \    station_data = parse_content_fields(content)\n    if not station_data:\n\
          \        return None\n\n    station_name = station_data.get('ç«™å', '').strip()\n\
          \    category = station_data.get('é¡åˆ¥', '').strip()\n    status = station_data.get('å­˜å»¢ç‹€æ…‹',\
          \ '').strip()\n    station_number = station_data.get('ç«™è™Ÿ', '').strip()\n\
          \    weather_code = station_data.get('æ°£è±¡ç½²ç«™è™Ÿ', '').strip()\n\n    if not\
          \ station_name or not category:\n        return None\n\n    display_name\
          \ = station_name + (\" (å·²å»¢)\" if status == \"å·²å»¢\" else \"\")\n\n    if target_data_type\
          \ and target_data_type not in (\"æœªæŒ‡å®š\", \"å¤šçµæœæŸ¥è©¢\"):\n        if not type_matches(category,\
          \ target_data_type):\n            return None\n\n    if category == 'é›¨é‡':\n\
          \        primary_code = weather_code or station_number\n        station_type\
          \ = \"rainfall\"\n    elif category == 'æ°´ä½æµé‡å«æ²™é‡':\n        primary_code\
          \ = station_number or weather_code\n        station_type = \"waterLevel\"\
          \n    elif category == 'åœ°ä¸‹æ°´ä½':\n        primary_code = station_number or\
          \ weather_code\n        station_type = \"groundwater\"\n    else:\n    \
          \    return None\n\n    if not primary_code:\n        return None\n\n  \
          \  return {\n        \"station_name\": display_name,\n        \"original_name\"\
          : station_name,\n        \"station_code\": primary_code,\n        \"station_number\"\
          : station_number,\n        \"weather_code\": weather_code,\n        \"data_category\"\
          : category,\n        \"station_type\": station_type,\n        \"status\"\
          : status or \"ç¾å­˜\",\n        \"management_unit\": station_data.get('ç®¡ç†å–®ä½',\
          \ ''),\n        \"watershed\": station_data.get('æµåŸŸ', ''),\n        \"river\"\
          : station_data.get('æ²³å·', ''),\n        \"address\": station_data.get('åœ°å€',\
          \ ''),\n        \"county\": station_data.get('ç¸£å¸‚', ''),\n        \"elevation\"\
          : station_data.get('é«˜ç¨‹(m)', ''),\n        \"coordinates\": extract_coordinates(station_data),\n\
          \        \"data_periods\": extract_data_periods(station_data, category)\n\
          \    }\n\n\ndef parse_content_fields(content: str) -> Dict[str, str]:\n\
          \    try:\n        parts = content.split(';')\n        data = {}\n     \
          \   for part in parts:\n            if '\":\"' in part:\n              \
          \  key, value = part.split('\":\"', 1)\n                key = key.replace('\"\
          ', '').replace('\\\\', '').strip()\n                value = value.replace('\"\
          ', '').replace('\\\\', '').strip()\n                if key and value !=\
          \ \"-\":\n                    data[key] = value\n        return data\n \
          \   except Exception:\n        return {}\n\n\ndef extract_data_periods(station_data:\
          \ Dict[str, str], data_category: str = None) -> Dict[str, str]:\n    time_fields_map\
          \ = {\n        \"é›¨é‡\": ['æ™‚é›¨é‡', 'æ—¥é›¨é‡', 'æœˆé›¨é‡'],\n        \"æ°´ä½æµé‡å«æ²™é‡\": ['æ™‚æ°´ä½',\
          \ 'æ—¥æ°´ä½', 'æœˆæ°´ä½'],\n        \"åœ°ä¸‹æ°´ä½\": ['æ™‚åœ°ä¸‹æ°´ä½', 'æ—¥åœ°ä¸‹æ°´ä½', 'æœˆåœ°ä¸‹æ°´ä½'],\n    }\n\
          \    default_fields = [\n        'æ™‚æ°´ä½', 'æ—¥æ°´ä½', 'æœˆæ°´ä½',\n        'æ™‚é›¨é‡', 'æ—¥é›¨é‡',\
          \ 'æœˆé›¨é‡',\n        'æ™‚åœ°ä¸‹æ°´ä½', 'æ—¥åœ°ä¸‹æ°´ä½', 'æœˆåœ°ä¸‹æ°´ä½'\n    ]\n\n    time_fields =\
          \ time_fields_map.get(data_category, default_fields)\n    return {field:\
          \ station_data[field].strip() for field in time_fields if field in station_data\
          \ and station_data[field] and station_data[field] != \"-\"}\n\n\ndef extract_coordinates(station_data:\
          \ Dict[str, str]) -> Dict[str, str]:\n    coordinates = {}\n    x = station_data.get('TWD97M2(Xåæ¨™)',\
          \ '').strip()\n    y = station_data.get('TWD97M2(Yåæ¨™)', '').strip()\n  \
          \  if x and x != \"-\":\n        coordinates[\"x\"] = x\n    if y and y\
          \ != \"-\":\n        coordinates[\"y\"] = y\n    return coordinates\n\n\n\
          def build_profile_url(station_code: str, data_category: str) -> str:\n \
          \   if not station_code or not data_category:\n        return \"\"\n   \
          \ api_types = {\n        \"é›¨é‡\": \"RA\",\n        \"æ°´ä½æµé‡å«æ²™é‡\": \"LE\",\n\
          \        \"åœ°ä¸‹æ°´ä½\": \"GW\"\n    }\n    api_type = api_types.get(data_category,\
          \ \"\")\n    if not api_type:\n        return \"\"\n    return f\"https://gweb.wra.gov.tw/HydroInfo/StDataInfo/StDataInfo?{api_type}&{station_code}\"\
          \n\n\ndef type_matches(station_category: str, target_data_type: str) ->\
          \ bool:\n    for standard_type, aliases in TYPE_MAPPING.items():\n     \
          \   if station_category == standard_type:\n            return target_data_type\
          \ == standard_type or target_data_type in aliases\n    return False\n\n\n\
          def remove_duplicate_stations(stations_json_list: List[Union[str, Dict[str,\
          \ Any]]]) -> List[Union[str, Dict[str, Any]]]:\n    if not stations_json_list:\n\
          \        return []\n    seen_codes = set()\n    unique_stations = []\n \
          \   for station_json in stations_json_list:\n        try:\n            station\
          \ = json.loads(station_json) if isinstance(station_json, str) else station_json\n\
          \        except json.JSONDecodeError:\n            continue\n        code\
          \ = station.get('station_code', '')\n        if code and code not in seen_codes:\n\
          \            seen_codes.add(code)\n            unique_stations.append(station_json)\n\
          \    return unique_stations\n\n\ndef build_complete_station_profile(station:\
          \ Dict[str, Any], api_url: str) -> Dict[str, Any]:\n    \"\"\"\n    å¹³é‹ªç‰ˆæ¸¬ç«™åŸºæœ¬è³‡æ–™çµ„å»º\
          \ - ç§»é™¤é‡è¤‡æ¬„ä½\n    å°é½Šè§€æ¸¬è³‡æ–™æ ¼å¼ï¼Œæ–¹ä¾¿ LLM è®€å–\n    \"\"\"\n    station_data = {\n \
          \       # æ ¸å¿ƒè³‡è¨Š\n        \"station_name\": station.get(\"station_name\",\
          \ \"\"),\n        \"station_code\": station.get(\"station_code\", \"\"),\n\
          \        \"data_category\": station.get(\"data_category\", \"\"),\n    \
          \    \"api_url\": api_url,\n        \n        # å¹³é‹ªçµæ§‹ - ç›´æ¥æ¬„ä½ï¼Œä¸åµŒå¥—\n      \
          \  \"management_unit\": station.get(\"management_unit\", \"\"),\n      \
          \  \"watershed\": station.get(\"watershed\", \"\"),\n        \"river\":\
          \ station.get(\"river\", \"\"),\n        \"address\": station.get(\"address\"\
          , \"\"),\n        \"county\": station.get(\"county\", \"\"),\n        \"\
          status\": station.get(\"status\", \"\"),\n        \n        # ä¿ç•™åŸæœ‰çµæ§‹\n \
          \       \"data_periods\": station.get(\"data_periods\", {}),\n        \"\
          coordinates\": station.get(\"coordinates\", {})\n    }\n    \n    # é«˜ç¨‹è³‡è¨Š\n\
          \    if station.get(\"elevation\"):\n        station_data[\"elevation\"\
          ] = station.get(\"elevation\")\n    \n    # åªä¿ç•™ä¸€å€‹çµ„åˆä½ç½®è³‡è¨Šå­—ä¸² - æ–¹ä¾¿ LLM å¿«é€Ÿè®€å–\n\
          \    location_parts = []\n    for field in [\"management_unit\", \"watershed\"\
          , \"river\", \"address\"]:\n        if station.get(field):\n           \
          \ location_parts.append(station.get(field))\n    \n    if location_parts:\n\
          \        station_data[\"location_info\"] = \"ã€\".join(location_parts)\n\
          \    \n    return station_data\n\ndef analyze_failure_reason(item: Dict[str,\
          \ Any], target_data_type: str) -> str:\n    content = item.get(\"content\"\
          , \"\")\n    if not content:\n        return \"ç„¡contentå…§å®¹\"\n    station_data\
          \ = parse_content_fields(content)\n    if not station_data:\n        return\
          \ \"contentè§£æå¤±æ•—\"\n    station_name = station_data.get('ç«™å', '').strip()\n\
          \    category = station_data.get('é¡åˆ¥', '').strip()\n    if not station_name:\n\
          \        return \"ç¼ºå°‘ç«™å\"\n    if not category:\n        return \"ç¼ºå°‘é¡åˆ¥\"\n\
          \    if target_data_type and not type_matches(category, target_data_type):\n\
          \        return f\"è³‡æ–™é¡å‹ä¸ç¬¦({category}â‰ {target_data_type})\"\n    return \"\
          å…¶ä»–åŸå› \"\n\n\ndef empty_result(location: str, dataType: str) -> Dict[str,\
          \ Any]:\n    return {\n        \"stationsData\": [],\n        \"queryInfo\"\
          : {\n            \"location\": location,\n            \"dataType\": dataType,\n\
          \            \"foundStations\": 0,\n            \"stationNames\": [],\n\
          \            \"result_type\": \"no_match\"\n        },\n        \"debug_info\"\
          : {\n            \"raw_count\": 0,\n            \"processed_stations\":\
          \ [],\n            \"failed_reasons\": {}\n        }\n    }\n\n\ndef error_result(location:\
          \ str, dataType: str, error_msg: str) -> Dict[str, Any]:\n    return {\n\
          \        \"stationsData\": [],\n        \"queryInfo\": {\n            \"\
          location\": location,\n            \"dataType\": dataType,\n           \
          \ \"foundStations\": 0,\n            \"stationNames\": [],\n           \
          \ \"result_type\": \"error\"\n        },\n        \"debug_info\": {\n  \
          \          \"error\": f\"ç³»çµ±éŒ¯èª¤: {error_msg}\",\n            \"raw_count\"\
          : 0,\n            \"processed_stations\": [],\n            \"failed_reasons\"\
          : {}\n        }\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          debug_info:
            children: null
            type: object
          queryInfo:
            children: null
            type: object
          stationsData:
            children: null
            type: array[string]
        selected: false
        title: æ•´åˆçŸ¥è­˜æª¢ç´¢
        type: code
        variables:
        - value_selector:
          - '1749723734934'
          - output
          variable: Integration
      height: 52
      id: '1749722175647'
      position:
        x: 1814
        y: 506
      positionAbsolute:
        x: 1814
        y: 506
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: true
          variable_selector:
          - '1749722175647'
          - stationsData
        desc: ''
        model:
          completion_params:
            temperature: 0.1
          mode: chat
          name: gpt-4o-mini
          provider: langgenius/azure_openai/azure_openai
        prompt_template:
        - id: dad51268-06bc-48fa-a571-027c9015ce17
          role: system
          text: '# Identity ä½ æ˜¯å°ˆæ¥­çš„å°ç£æ°´æ–‡æ¸¬ç«™è³‡æ–™ç¯©é¸å°ˆå®¶ï¼Œè² è²¬æ ¹æ“šç”¨æˆ¶æŸ¥è©¢ç²¾æº–ç¯©é¸æ¸¬ç«™è³‡æ–™ã€‚ # Instructions ##
            æ ¸å¿ƒè¦å‰‡ï¼ˆæŒ‰å„ªå…ˆç´šæ’åºï¼‰ 1. **åœ°ç†ä½ç½®æœ€å„ªå…ˆ**ï¼šè‹¥ç”¨æˆ¶æŒ‡å®šç¸£å¸‚ï¼Œå¿…é ˆåš´æ ¼ç¯©é¸ï¼Œä¸ç¬¦åˆçš„ä¸€å¾‹æ’é™¤ 2. **ç«™åå¯¬é¬†åŒ¹é…**ï¼šåœ¨é€šéåœ°ç†ç¯©é¸çš„æ¸¬ç«™ä¸­ï¼Œé€²è¡Œæ¨¡ç³ŠåŒ¹é…
            3. **å·²å»¢æ¸¬ç«™ä¿ç•™**ï¼šå·²å»¢æ¸¬ç«™æœ‰æ­·å²åƒ¹å€¼ï¼Œç¬¦åˆæ¢ä»¶å°±ç´å…¥ ## åŸ·è¡Œæ­¥é©Ÿ ### æ­¥é©Ÿ1ï¼šè§£æç”¨æˆ¶æŸ¥è©¢ å¾æŸ¥è©¢ä¸­æå–ï¼š - **åœ°ç†é™åˆ¶**ï¼šå°åŒ—ã€æ–°åŒ—ã€æ¡ƒåœ’ã€å°ä¸­ã€å°å—ã€é«˜é›„ç­‰ç¸£å¸‚åç¨±
            - **æ¸¬ç«™é—œéµå­—**ï¼šä¸­æ­£æ©‹ã€çŸ³é–€ã€ç¿¡ç¿ ç­‰ - **è³‡æ–™é¡å‹**ï¼šé›¨é‡ã€æ°´ä½ã€åœ°ä¸‹æ°´ä½ ### æ­¥é©Ÿ2ï¼šåœ°ç†ä½ç½®ç¯©é¸ï¼ˆæœ€é«˜å„ªå…ˆç´šï¼å¿…é ˆå…ˆåŸ·è¡Œï¼ï¼‰
            **è¦å‰‡ï¼š** - è‹¥ç”¨æˆ¶æŸ¥è©¢**åŒ…å«**ç¸£å¸‚åç¨± â†’ å¼·åˆ¶ç¯©é¸ï¼Œåªä¿ç•™è©²ç¸£å¸‚çš„æ¸¬ç«™ - è‹¥ç”¨æˆ¶æŸ¥è©¢**ä¸åŒ…å«**ç¸£å¸‚åç¨± â†’ è·³éæ­¤æ­¥é©Ÿï¼Œä¿ç•™æ‰€æœ‰æ¸¬ç«™
            **å¼·åˆ¶ç¯©é¸æ™‚ï¼š** - âœ… åªä¿ç•™ county æˆ– address åŒ…å«è©²ç¸£å¸‚çš„æ¸¬ç«™ - âŒ å¿…é ˆæ’é™¤å…¶ä»–ç¸£å¸‚çš„æ¸¬ç«™ï¼Œå³ä½¿ç«™åå®Œå…¨ç›¸åŒ
            - è‹¥ç¯©é¸å¾Œç„¡çµæœï¼Œresult_type è¨­ç‚º "none"ï¼Œselected_stations ç‚ºç©ºé™£åˆ— **ç¯„ä¾‹ï¼š** | ç”¨æˆ¶æŸ¥è©¢
            | æœ‰ç„¡åœ°ç†é™åˆ¶ | æ­£ç¢ºåšæ³• | |---------|-------------|---------| | å°åŒ—ä¸­æ­£æ©‹ | æœ‰ï¼ˆå°åŒ—ï¼‰|
            åªé¸ county/address å«ã€Œå°åŒ—ã€çš„ | | ä¸­æ­£æ©‹ | ç„¡ | åˆ—å‡ºæ‰€æœ‰ä¸­æ­£æ©‹è®“ç”¨æˆ¶é¸æ“‡ | ### æ­¥é©Ÿ3ï¼šç«™åå¯¬é¬†åŒ¹é…ï¼ˆåœ¨æ­¥é©Ÿ2çµæœä¸­åŸ·è¡Œï¼‰
            å°é€šéåœ°ç†ç¯©é¸çš„æ¸¬ç«™ï¼Œé€²è¡Œç«™åæ¨¡ç³ŠåŒ¹é…ï¼š - ã€Œä¸­æ­£æ©‹ã€â†’ åŒ¹é…ã€Œä¸­æ­£æ©‹ã€ã€ã€Œä¸­æ­£æ©‹(å³æ™‚)ã€ã€ã€Œä¸­æ­£æ©‹(å·²å»¢)ã€ã€ã€Œä¸­æ­£å¤§æ©‹ã€ - ã€Œç«¹æ—å¤§æ©‹ã€â†’
            åŒ¹é…ã€Œç«¹æ—å¤§æ©‹ã€ã€ã€Œç«¹æ—å¤§æ©‹(å·¦å²¸)ã€ ### æ­¥é©Ÿ4ï¼šè¼¸å‡ºå‰è‡ªæˆ‘æª¢æŸ¥ - [ ] è‹¥ç”¨æˆ¶æŒ‡å®šç¸£å¸‚ï¼Œçµæœä¸­æ˜¯å¦**å…¨éƒ¨**ç¬¦åˆè©²ç¸£å¸‚ï¼Ÿ -
            [ ] æœ‰ç„¡èª¤é¸å…¶ä»–ç¸£å¸‚çš„æ¸¬ç«™ï¼Ÿè‹¥æœ‰ï¼Œå¿…é ˆç§»é™¤ï¼ <CONTEXT> {{#context#}} </CONTEXT> # Output Format
            æ ¹æ“šç¯©é¸çµæœè¨­å®š result_typeï¼š - 0 ç­†çµæœ â†’ "none" - 1 ç­†çµæœ â†’ "single" - 2 ç­†ä»¥ä¸Š â†’ "multiple"
            åªè¼¸å‡º JSONï¼Œç„¡å…¶ä»–æ–‡å­—ï¼š { "result_type": "none|single|multiple", "selected_stations":
            [ { "station_name": "æ¸¬ç«™åç¨±", "station_code": "æ¸¬ç«™ä»£ç¢¼", "api_url": "APIç¶²å€",
            "address": "æ¸¬ç«™åœ°å€" } ] }'
        - id: 5c3d89aa-6840-4326-8571-9ea49c04361c
          role: user
          text: '{{#1749456115056.userQuery#}}'
        selected: false
        structured_output:
          schema:
            properties:
              result_type:
                enum:
                - single
                - multiple
                type: string
              selected_stations:
                items:
                  properties:
                    address:
                      type: string
                    api_url:
                      type: string
                    station_code:
                      type: string
                    station_name:
                      type: string
                  required:
                  - station_name
                  - station_code
                  - api_url
                  - address
                  type: object
                type: array
            required:
            - result_type
            - selected_stations
            type: object
        structured_output_enabled: true
        title: LLM
        type: llm
        variables: []
        vision:
          enabled: false
      height: 88
      id: '1749722223032'
      position:
        x: 2121.9264962431166
        y: 506
      positionAbsolute:
        x: 2121.9264962431166
        y: 506
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        selected: false
        template: "{% set info_greetings = [\r\n  \"å°æ°´æ»´ç‚ºæ‚¨æŸ¥è©¢åˆ°äº†\",\r\n  \"å°æ°´æ»´æˆåŠŸå–å¾—äº†\"\
          , \r\n  \"å°æ°´æ»´æ‰¾åˆ°äº†\",\r\n  \"å°æ°´æ»´æœå°‹åˆ°äº†\",\r\n  \"å°æ°´æ»´å¹«æ‚¨æº–å‚™å¥½äº†\"\r\n] %}\r\n\r\n\
          {% set info_multiple_greetings = [\r\n  \"å°æ°´æ»´æ‰¾åˆ°äº†å¤šå€‹ç›¸é—œæ¸¬ç«™\",\r\n  \"å°æ°´æ»´æœå°‹åˆ°äº†å¹¾å€‹æ¸¬ç«™\"\
          , \r\n  \"å°æ°´æ»´ç‚ºæ‚¨æ‰¾åˆ°äº†ç›¸é—œæ¸¬ç«™\",\r\n  \"å°æ°´æ»´ç™¼ç¾äº†å¤šå€‹æ¸¬ç«™é¸é …\",\r\n  \"å°æ°´æ»´å¹«æ‚¨æº–å‚™äº†æ¸¬ç«™æ¸…å–®\"\r\
          \n] %}\r\n\r\n{% set info_error_messages = [\r\n  \"å°æ°´æ»´å¾ˆæŠ±æ­‰ï¼Œæ²’æœ‰æ‰¾åˆ°ç›¸é—œæ¸¬ç«™è³‡æ–™\"\
          ,\r\n  \"å°æ°´æ»´æœå°‹å¾Œï¼Œæœªç™¼ç¾ç¬¦åˆæ¢ä»¶çš„æ¸¬ç«™\",\r\n  \"å°æ°´æ»´æŸ¥è©¢äº†è³‡æ–™åº«ï¼Œæš«ç„¡ç›¸é—œæ¸¬ç«™è³‡è¨Š\",\r\n  \"å°æ°´æ»´åŠªåŠ›æŸ¥æ‰¾ï¼Œä½†æ²’æœ‰æ‰¾åˆ°åŒ¹é…çš„æ¸¬ç«™\"\
          \r\n] %}\r\n\r\n{% if selected_stations and selected_stations|length > 0\
          \ %}\r\n  {% set stations = selected_stations %}\r\n\r\n  {% if stations|length\
          \ == 1 %}\r\n    {% set random_greeting = info_greetings[range(0, info_greetings|length)\
          \ | random] %}\r\n    {% set station = stations[0] %}\r\n\r\n**{{ random_greeting\
          \ }}æ¸¬ç«™åŸºæœ¬è³‡æ–™ï¼š**\r\n\r\n**{{ station.station_name }}**  \r\næ¸¬ç«™ç·¨è™Ÿï¼š{{ station.station_code\
          \ }}  \r\n{%- if station.location_info %}\r\n{%- set address = station.location_info.split('ã€')[-1]\
          \ %}\r\nè¨­ç½®åœ°é»ï¼š{{ address }}  \r\n{%- endif %}\r\n[æŸ¥çœ‹æ¸¬ç«™è³‡æ–™]({{ station.api_url\
          \ }})\r\n\r\n  {% else %}\r\n    {% set random_multiple = info_multiple_greetings[range(0,\
          \ info_multiple_greetings|length) | random] %}\r\n\r\n**{{ random_multiple\
          \ }}ï¼Œè«‹é¸æ“‡æ‚¨éœ€è¦çš„æ¸¬ç«™ï¼š**\r\n\r\n{% for station in stations -%}\r\n**{{ loop.index\
          \ }}. {{ station.station_name }}**  \r\næ¸¬ç«™ç·¨è™Ÿï¼š{{ station.station_code }}\
          \  \r\n{%- if station.location_info %}\r\n{%- set address = station.location_info.split('ã€')[-1]\
          \ %}\r\nè¨­ç½®åœ°é»ï¼š{{ address }}  \r\n{%- endif %}\r\n[æŸ¥çœ‹æ¸¬ç«™è³‡æ–™]({{ station.api_url\
          \ }})\r\n\r\n{% endfor %}\r\n  {% endif %}\r\n\r\n{% if stations|length\
          \ == 10 %}\r\n---\r\n**å°æ°´æ»´æº«é¦¨æé†’ï¼š** ç³»çµ±ä¸­æœ‰ {{ stations|length }} å€‹æ¸¬ç«™åŸºæœ¬è³‡æ–™ã€‚\r\n\
          \r\næŸ¥è©¢æ›´å¤šæ¸¬ç«™åŸºæœ¬è³‡æ–™ï¼š[å‰å¾€æ°´æ–‡è³‡è¨Šç¶²](https://gweb.wra.gov.tw/Hydroinfo/?id=Index)\r\n\
          {% endif %}\r\n\r\n{% else %}\r\n  {% set random_error = info_error_messages[range(0,\
          \ info_error_messages|length) | random] %}\r\n\r\n**{{ random_error }}ï¼Œè«‹ç¢ºèªæ¸¬ç«™åç¨±æˆ–å˜—è©¦å…¶ä»–é—œéµå­—ã€‚**\r\
          \n\r\n  {% if validation_stats and validation_stats.original_count > 0 %}\r\
          \n\r\nå°æ°´æ»´æ ¹æ“šæ‚¨çš„é—œéµå­—æ‰¾åˆ°ä¸€äº›å¯èƒ½çš„æ–¹å‘ï¼Œä½†æ¯”å°å®˜æ–¹è³‡æ–™å¾Œï¼Œç™¼ç¾å®ƒå€‘ä¸¦éæœ‰æ•ˆçš„æ¸¬ç«™åç¨±ã€‚\r\n\r\n**å»ºè­°æ‚¨å¯ä»¥ï¼š**\r\n\
          - æª¢æŸ¥è¼¸å…¥çš„åç¨±æ˜¯å¦æœ‰éŒ¯å­—  \r\n- å˜—è©¦ä½¿ç”¨æ›´ç°¡çŸ­çš„é—œéµå­—\r\n  {% endif %}\r\n{% endif %}"
        title: æ¨¡æ¿è½‰æ›
        type: template-transform
        variables:
        - value_selector:
          - '1750412940660'
          - result_type
          variable: result_type
        - value_selector:
          - '1750412940660'
          - selected_stations
          variable: selected_stations
        - value_selector:
          - '1750412940660'
          - validation_stats
          variable: validation_stats
      height: 52
      id: '1749722290058'
      position:
        x: 2725.829190444224
        y: 506
      positionAbsolute:
        x: 2725.829190444224
        y: 506
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1749722290058'
          - output
          variable: output
        selected: false
        title: çµæŸ 2
        type: end
      height: 88
      id: '1749722325395'
      position:
        x: 3026.4842834334895
        y: 506
      positionAbsolute:
        x: 3026.4842834334895
        y: 506
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: is
            id: 15245a85-b822-4212-bbb9-5fff39ee9a59
            value: å¤šçµæœæŸ¥è©¢
            varType: string
            variable_selector:
            - '1749456115056'
            - dataType
          - comparison_operator: contains
            id: d60b3fff-f89c-4486-9b16-e5266b09f962
            value: success
            varType: string
            variable_selector:
            - '1749456115056'
            - status
          id: 'true'
          logical_operator: and
        - case_id: 3bfecbbd-e017-475e-becb-6140c55db596
          conditions:
          - comparison_operator: is not
            id: c469bb29-fc11-46ed-84cf-87fed5bc3756
            value: å¤šçµæœæŸ¥è©¢
            varType: string
            variable_selector:
            - '1749456115056'
            - dataType
          - comparison_operator: contains
            id: eb120398-03e2-4424-87e7-632778c1ecda
            value: success
            varType: string
            variable_selector:
            - '1749456115056'
            - status
          id: 3bfecbbd-e017-475e-becb-6140c55db596
          logical_operator: and
        - case_id: a603ccde-7469-4a4e-866e-d233c4a15c56
          conditions:
          - comparison_operator: contains
            id: dfe95153-b5d9-4817-a4c0-b0a5df67c838
            value: incomplete
            varType: string
            variable_selector:
            - '1749456115056'
            - status
          id: a603ccde-7469-4a4e-866e-d233c4a15c56
          logical_operator: and
        desc: ''
        selected: false
        title: æ¢ä»¶åˆ†æ”¯
        type: if-else
      height: 272
      id: '1749723660697'
      position:
        x: 638
        y: 506
      positionAbsolute:
        x: 638
        y: 506
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        dataset_ids:
        - NhQ1VRTfIvcco/vcDT/dTKd4KIKZvL8bJPKsVMHa5KNMbi9zQisPmhN4oURWzKq5
        desc: ''
        metadata_filtering_conditions:
          conditions:
          - comparison_operator: is
            id: ab318b5d-8287-4747-a6df-858665f48a57
            name: type
            value: '{{#1749456115056.dataType#}}'
          logical_operator: and
        metadata_filtering_mode: manual
        multiple_retrieval_config:
          reranking_enable: true
          reranking_mode: reranking_model
          reranking_model:
            model: netease-youdao/bce-reranker-base_v1
            provider: langgenius/siliconflow/siliconflow
          score_threshold: 0.4
          top_k: 10
        query_variable_selector:
        - '1749456115056'
        - userQuery
        retrieval_mode: multiple
        selected: false
        title: çŸ¥è­˜æª¢ç´¢ 2
        type: knowledge-retrieval
      height: 90
      id: '1749723712811'
      position:
        x: 1072.2915554978538
        y: 510.59479341998815
      positionAbsolute:
        x: 1072.2915554978538
        y: 510.59479341998815
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        output_type: array[object]
        selected: false
        title: è®Šé‡èšåˆå™¨
        type: variable-aggregator
        variables:
        - - '1749722091423'
          - output
        - - '1749723712811'
          - result
      height: 134
      id: '1749723734934'
      position:
        x: 1510
        y: 506
      positionAbsolute:
        x: 1510
        y: 506
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        selected: false
        template: "{% set friendly_responses = [\r\n  \"å°æ°´æ»´æƒ³å¹«æ‚¨æŸ¥è©¢æ¸¬ç«™è³‡æ–™ï¼Œä¸ééœ€è¦æ‚¨å†æä¾›ä¸€äº›è³‡è¨Š\"\
          ,\r\n  \"å°æ°´æ»´å·®ä¸€é»å°±èƒ½å¹«æ‚¨æŸ¥åˆ°äº†ï¼Œè«‹å†è£œå……ä¸€ä¸‹è³‡è¨Š\",\r\n  \"å°æ°´æ»´éœ€è¦æ‚¨æä¾›æ›´å¤šè³‡è¨Šï¼Œæ‰èƒ½ç²¾æº–æŸ¥è©¢\",\r\n  \"\
          ç‚ºäº†æ‰¾åˆ°æ­£ç¢ºçš„æ¸¬ç«™è³‡æ–™ï¼Œå°æ°´æ»´éœ€è¦æ‚¨è£œå……è³‡è¨Š\"\r\n] %}\r\n{% set random_response = friendly_responses[range(0,\
          \ friendly_responses|length) | random] %}\r\n\r\n**{{ random_response }}**\
          \ \U0001F60A\r\n\r\n{% if \"location\" in missing_fields and \"dataType\"\
          \ in missing_fields %}\r\nè«‹å‘Šè¨´æˆ‘ï¼š\r\n**è¦æŸ¥å“ªå€‹æ¸¬ç«™æˆ–åœ°å€ï¼Ÿ**ï¼ˆä¾‹å¦‚ï¼šä¸­æ­£æ©‹ã€çŸ³é–€æ°´åº«ã€æ·¡æ°´æ²³æµåŸŸï¼‰\r\n\
          **è¦æŸ¥ä»€éº¼é¡å‹çš„è³‡æ–™ï¼Ÿ**ï¼ˆé›¨é‡ã€æ°´ä½ã€åœ°ä¸‹æ°´ä½ï¼‰\r\n\r\n{% elif \"location\" in missing_fields\
          \ %}\r\nè«‹å‘Šè¨´æˆ‘ï¼š\r\n**è¦æŸ¥å“ªå€‹æ¸¬ç«™æˆ–åœ°å€ï¼Ÿ**\r\nä¾‹å¦‚ï¼šä¸­æ­£æ©‹æ¸¬ç«™ã€å°åŒ—åœ°å€ã€æ·¡æ°´æ²³æµåŸŸ\r\n\r\n{% elif \"\
          dataType\" in missing_fields %}\r\nè«‹å‘Šè¨´æˆ‘ï¼š\r\n**è¦æŸ¥ä»€éº¼é¡å‹çš„è³‡æ–™ï¼Ÿ**\r\n- é›¨é‡æ¸¬ç«™è³‡æ–™\r\
          \n- æ°´ä½æ¸¬ç«™è³‡æ–™  \r\n- åœ°ä¸‹æ°´ä½æ¸¬ç«™è³‡æ–™\r\n\r\n{% else %}\r\n{% set system_messages =\
          \ [\r\n  \"å°æ°´æ»´é‡åˆ°äº†æŠ€è¡“å•é¡Œï¼Œè«‹ç¨å¾Œå†è©¦ä¸€æ¬¡\",\r\n  \"ç³»çµ±æš«æ™‚ç„¡æ³•è™•ç†æ‚¨çš„æŸ¥è©¢ï¼Œè«‹ç¨å¾Œé‡æ–°å˜—è©¦\",\r\n  \"\
          å°æ°´æ»´çš„ç³»çµ±å‡ºç¾äº†å°ç‹€æ³ï¼Œè«‹éä¸€æœƒå…’å†å•æˆ‘\",\r\n  \"å¾ˆæŠ±æ­‰ï¼Œå°æ°´æ»´ç¾åœ¨ç„¡æ³•æŸ¥è©¢ï¼Œè«‹ç¨å¾Œå†è©¦\"\r\n] %}\r\n{% set\
          \ random_system = system_messages[range(0, system_messages|length) | random]\
          \ %}\r\n**{{ random_system }}** â³\r\n{% endif %}\r\n\r\n---\r\n**å¿«é€Ÿç¯„ä¾‹**ï¼š\r\
          \n- ã€Œä¸­æ­£æ©‹æ°´ä½æ¸¬ç«™è³‡æ–™ã€\r\n- ã€Œæ·¡æ°´æ²³æµåŸŸæœ‰å“ªäº›æ¸¬ç«™ã€"
        title: æ¨¡æ¿è½‰æ› 2
        type: template-transform
        variables:
        - value_selector:
          - '1749456115056'
          - missing_fields
          variable: missing_fields
      height: 52
      id: '1750300475652'
      position:
        x: 995.4285714285716
        y: 880
      positionAbsolute:
        x: 995.4285714285716
        y: 880
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1750300475652'
          - output
          variable: output
        selected: false
        title: çµæŸ 3
        type: end
      height: 88
      id: '1750300953338'
      position:
        x: 1510
        y: 891
      positionAbsolute:
        x: 1510
        y: 891
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import json\n\ndef main(llm_output, stationsData, userQuery=\"\", **kwargs):\n\
          \    try:\n        # å¾ userQuery æå–åœ°ç†é™åˆ¶\n        geo_keywords = {\n    \
          \        \"å°åŒ—\": [\"å°åŒ—\", \"è‡ºåŒ—\"],\n            \"æ–°åŒ—\": [\"æ–°åŒ—\"],\n    \
          \        \"æ¡ƒåœ’\": [\"æ¡ƒåœ’\"],\n            \"å°ä¸­\": [\"å°ä¸­\", \"è‡ºä¸­\"],\n    \
          \        \"å°å—\": [\"å°å—\", \"è‡ºå—\"],\n            \"é«˜é›„\": [\"é«˜é›„\"],\n    \
          \        \"æ–°ç«¹\": [\"æ–°ç«¹\"],\n            \"è‹—æ —\": [\"è‹—æ —\"],\n            \"\
          å½°åŒ–\": [\"å½°åŒ–\"],\n            \"å—æŠ•\": [\"å—æŠ•\"],\n            \"é›²æ—\": [\"\
          é›²æ—\"],\n            \"å˜‰ç¾©\": [\"å˜‰ç¾©\"],\n            \"å±æ±\": [\"å±æ±\"],\n \
          \           \"å®œè˜­\": [\"å®œè˜­\"],\n            \"èŠ±è“®\": [\"èŠ±è“®\"],\n         \
          \   \"å°æ±\": [\"å°æ±\", \"è‡ºæ±\"],\n            \"æ¾æ¹–\": [\"æ¾æ¹–\"],\n         \
          \   \"é‡‘é–€\": [\"é‡‘é–€\"],\n            \"é€£æ±Ÿ\": [\"é€£æ±Ÿ\", \"é¦¬ç¥–\"],\n         \
          \   \"åŸºéš†\": [\"åŸºéš†\"],\n        }\n        \n        target_geo = None\n\
          \        for geo, variants in geo_keywords.items():\n            if any(v\
          \ in userQuery for v in variants):\n                target_geo = geo\n \
          \               break\n        \n        # 1. å»ºç«‹ç™½åå–®ï¼šç”¨ station_code ç•¶ key\n\
          \        whitelist_by_code = {}\n        for item in stationsData:\n   \
          \         data = json.loads(item) if isinstance(item, str) else item\n \
          \           code = data.get(\"station_code\", \"\").strip()\n          \
          \  \n            if code:\n                whitelist_by_code[code] = data\n\
          \        \n        # 2. è§£æ LLM è¼¸å‡º\n        if isinstance(llm_output, str):\n\
          \            llm_data = json.loads(llm_output)\n        else:\n        \
          \    llm_data = llm_output\n        \n        # 3. ç¯©é¸ï¼šç™½åå–®æ¯”å° + åœ°ç†ä½ç½®ç¯©é¸\n \
          \       valid_stations = []\n        seen = set()\n        \n        for\
          \ station in llm_data.get(\"selected_stations\", []):\n            code\
          \ = station.get(\"station_code\", \"\").strip()\n            \n        \
          \    if code not in whitelist_by_code or code in seen:\n               \
          \ continue\n            \n            station_data = whitelist_by_code[code]\n\
          \            \n            # åœ°ç†ä½ç½®ç¯©é¸ï¼ˆæœ‰æŒ‡å®šç¸£å¸‚æ™‚æ‰åŸ·è¡Œï¼‰\n            if target_geo:\n\
          \                county = station_data.get(\"county\", \"\")\n         \
          \       address = station_data.get(\"address\", \"\")\n                geo_variants\
          \ = geo_keywords.get(target_geo, [target_geo])\n                \n     \
          \           # ä¸ç¬¦åˆåœ°ç†é™åˆ¶ï¼Œè·³é\n                if not any(v in county or v in\
          \ address for v in geo_variants):\n                    continue\n      \
          \      \n            valid_stations.append(station_data)\n            seen.add(code)\n\
          \        \n        # 4. æ±ºå®šçµæœé¡å‹\n        if len(valid_stations) == 0:\n \
          \           result_type = \"none\"\n        elif len(valid_stations) ==\
          \ 1:\n            result_type = \"single\"\n        else:\n            result_type\
          \ = \"multiple\"\n        \n        return {\n            \"result_type\"\
          : result_type,\n            \"selected_stations\": valid_stations,\n   \
          \         \"validation_stats\": {\n                \"original_count\": len(llm_data.get(\"\
          selected_stations\", [])),\n                \"valid_count\": len(valid_stations),\n\
          \                \"whitelist_size\": len(whitelist_by_code),\n         \
          \       \"geo_filter\": target_geo\n            }\n        }\n        \n\
          \    except Exception as e:\n        import traceback\n        return {\n\
          \            \"result_type\": \"error\",\n            \"selected_stations\"\
          : [],\n            \"validation_stats\": {\n                \"original_count\"\
          : 0,\n                \"valid_count\": 0,\n                \"whitelist_size\"\
          : 0\n            },\n            \"error_details\": {\n                \"\
          error\": str(e),\n                \"traceback\": traceback.format_exc()[:1000],\n\
          \                \"llm_output_preview\": str(llm_output)[:300] if llm_output\
          \ else None,\n                \"stationsData_count\": len(stationsData)\
          \ if isinstance(stationsData, list) else 0\n            }\n        }"
        code_language: python3
        desc: ''
        outputs:
          result_type:
            children: null
            type: string
          selected_stations:
            children: null
            type: array[object]
          validation_stats:
            children: null
            type: object
        selected: true
        title: ä»£ç¢¼åŸ·è¡Œ 3
        type: code
        variables:
        - value_selector:
          - '1749722223032'
          - structured_output
          variable: llm_output
        - value_selector:
          - '1749722175647'
          - stationsData
          variable: stationsData
        - value_selector:
          - '1749456115056'
          - userQuery
          value_type: string
          variable: userQuery
      height: 52
      id: '1750412940660'
      position:
        x: 2418.0635874684604
        y: 506
      positionAbsolute:
        x: 2418.0635874684604
        y: 506
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        dataset_ids:
        - ZTPx9afl7Li0HMs8y8429quJqKDQfroCo4NLwdy7mbzwkXjHSJekexEjITNzhjAZ
        desc: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1749722091423'
        metadata_filtering_conditions:
          conditions:
          - comparison_operator: is
            id: d145f0a7-dfaa-47d3-a816-bcd3186a0383
            name: type
            value: '{{#1749456115056.dataType#}}'
          logical_operator: and
        metadata_filtering_mode: manual
        multiple_retrieval_config:
          reranking_enable: false
          reranking_mode: weighted_score
          reranking_model:
            model: netease-youdao/bce-reranker-base_v1
            provider: langgenius/siliconflow/siliconflow
          score_threshold: 0.4
          top_k: 4
          weights:
            keyword_setting:
              keyword_weight: 0
            vector_setting:
              embedding_model_name: bge-m3
              embedding_provider_name: langgenius/ollama/ollama
              vector_weight: 1
            weight_type: customized
        query_variable_selector:
        - '1749722091423'
        - item
        retrieval_mode: multiple
        selected: false
        title: çŸ¥è­˜æª¢ç´¢ 2
        type: knowledge-retrieval
      height: 90
      id: '1752140064990'
      parentId: '1749722091423'
      position:
        x: 162.24063977163792
        y: 84.29739670999413
      positionAbsolute:
        x: 1105.389338126635
        y: 718.0308028200051
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
      zIndex: 1002
    - data:
        author: geoinforadmin
        desc: ''
        height: 88
        selected: false
        showAuthor: true
        text: '{"root":{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"#
          Identity","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"ä½ æ˜¯å°ˆæ¥­çš„å°ç£æ°´æ–‡æ¸¬ç«™è³‡æ–™ç¯©é¸å°ˆå®¶ï¼Œè² è²¬æ ¹æ“šç”¨æˆ¶æŸ¥è©¢ç²¾æº–ç¯©é¸æ¸¬ç«™è³‡æ–™ã€‚","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"#
          Instructions","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"##
          çµ•å°é‡è¦çš„è¦å‰‡","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          å¿…é ˆé¸å‡ºæ‰€æœ‰ç¬¦åˆæ¢ä»¶çš„æ¸¬ç«™ï¼Œç„¡è«–ç‹€æ…‹æ˜¯ã€Œç¾å­˜ã€é‚„æ˜¯ã€Œå·²å»¢ã€","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          å·²å»¢æ¸¬ç«™å…·æœ‰æ­·å²æŸ¥è©¢åƒ¹å€¼ï¼Œä¸å¯æ’é™¤","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          å¯§å¯å¤šé¸ä¸å¯æ¼é¸ï¼Œç–‘ä¼¼ç¬¦åˆå°±ç´å…¥","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          å¿…é ˆæª¢æŸ¥ CONTEXT ä¸­çš„æ¯ä¸€ç­†è³‡æ–™","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"##
          åŸ·è¡Œæ­¥é©Ÿ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"###
          æ­¥é©Ÿ1ï¼šè§£ææŸ¥è©¢æ¢ä»¶","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"å¾ç”¨æˆ¶æŸ¥è©¢ä¸­æå–ï¼š","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          åœ°ç†ç¯„åœï¼ˆæµåŸŸã€ç¸£å¸‚ã€é„‰é®ç­‰ï¼‰","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          æ¸¬ç«™é¡å‹ï¼ˆé›¨é‡ã€æ°´ä½ã€åœ°ä¸‹æ°´ä½ï¼‰","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          å…¶ä»–æ¢ä»¶","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"###
          æ­¥é©Ÿ2ï¼šé€ç­†æª¢æŸ¥ï¼ˆå¿…é ˆå®Œæˆï¼‰","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"**å¼·åˆ¶è¦æ±‚**ï¼šå¿…é ˆæª¢æŸ¥
          CONTEXT ä¸­çš„æ¯ä¸€ç­†è³‡æ–™","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"**æª¢æŸ¥æ¸…å–®**ï¼ˆæ¯ç­†è³‡æ–™éƒ½è¦ç¢ºèªï¼‰ï¼š","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          [ ] watershedï¼ˆæµåŸŸï¼‰æ¬„ä½æ˜¯å¦åŒ…å«æŸ¥è©¢é—œéµè©","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          [ ] data_categoryï¼ˆè³‡æ–™é¡å‹ï¼‰æ¬„ä½æ˜¯å¦ç¬¦åˆ","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          [ ] ä¸å›  status ç‚ºã€Œå·²å»¢ã€è€Œæ’é™¤æ¸¬ç«™","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          [ ] ä¸å› å…¶ä»–æ¬„ä½ç‚ºç©ºè€Œæ’é™¤æ¸¬ç«™","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"###
          æ­¥é©Ÿ3ï¼šåœ°ç†ä½ç½®ç¯©é¸ï¼ˆæœ€é«˜å„ªå…ˆç´šï¼ï¼‰","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"å¦‚æœç”¨æˆ¶æŸ¥è©¢åŒ…å«åœ°ç†å€åŸŸï¼ˆå¦‚ã€Œå°åŒ—ã€ã€ã€Œæ–°åŒ—ã€ã€ã€Œå°å—ã€ã€ã€Œé«˜é›„ã€ç­‰ç¸£å¸‚åç¨±ï¼‰ï¼š","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"1.
          å¼·åˆ¶ç¯©é¸ï¼šåªé¸æ“‡ county æˆ– address æ¬„ä½åŒ…å«è©²åœ°ç†å€åŸŸçš„æ¸¬ç«™","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"2.
          æ’é™¤è¦å‰‡ï¼šæ˜ç¢ºæ’é™¤ä¸åœ¨è©²å€åŸŸçš„æ¸¬ç«™ 3. åªæœ‰ç•¶å®Œå…¨æ²’æœ‰ç¬¦åˆåœ°ç†æ¢ä»¶çš„æ¸¬ç«™æ™‚ï¼Œæ‰å‘ŠçŸ¥ç”¨æˆ¶ã€Œè©²å€åŸŸç„¡æ­¤æ¸¬ç«™ã€","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"ç¯„ä¾‹ï¼š","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          æŸ¥è©¢ã€Œå°åŒ—ä¸­æ­£æ©‹ã€â†’ åªé¸ county/address åŒ…å«ã€Œå°åŒ—ã€çš„ä¸­æ­£æ©‹ï¼Œæ’é™¤å°å—çš„","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          æŸ¥è©¢ã€Œæ–°åŒ—é›¨é‡ç«™ã€â†’ åªé¸ county ç‚ºã€Œæ–°åŒ—å¸‚ã€çš„æ¸¬ç«™","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          æŸ¥è©¢ã€Œä¸­æ­£æ©‹ã€ï¼ˆç„¡åœ°ç†é™åˆ¶ï¼‰â†’ åˆ—å‡ºæ‰€æœ‰ä¸­æ­£æ©‹æ¸¬ç«™è®“ç”¨æˆ¶é¸æ“‡","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"**å®Œæ•´åŒ¹é…æ¬„ä½**ï¼š","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"å°æ¯ç­†æ¸¬ç«™è³‡æ–™ï¼Œæª¢æŸ¥ä»¥ä¸‹æ¬„ä½æ˜¯å¦åŒ…å«æŸ¥è©¢é—œéµè©ï¼š","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          station_nameï¼ˆæ¸¬ç«™åç¨±ï¼‰","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          watershedï¼ˆæµåŸŸï¼‰","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          riverï¼ˆæ²³å·ï¼‰","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          countyï¼ˆç¸£å¸‚ï¼‰","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          addressï¼ˆåœ°å€ï¼‰","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          management_unitï¼ˆç®¡ç†å–®ä½ï¼‰","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          data_categoryï¼ˆè³‡æ–™é¡å‹ï¼‰","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"###
          æ­¥é©Ÿ3ï¼šåŒ¹é…è¦å‰‡","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          **å¯¬é¬†åŒ¹é…**ï¼šé—œéµè©åŒ…å«åœ¨ä»»ä¸€æ¬„ä½ä¸­å³é¸ä¸­","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          **åŒ…å«é—œä¿‚**ï¼šã€Œæ·¡æ°´æ²³æµåŸŸã€æ‡‰åŒ¹é…æ‰€æœ‰ watershed ç‚ºã€Œæ·¡æ°´æ²³ã€çš„æ¸¬ç«™","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          **æ¨¡ç³Šç«™å**ï¼š","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"1.
          è©¢å•ã€Œä¸­æ­£æ©‹ã€â†’ åŒ¹é…ã€Œä¸­æ­£æ©‹ã€ã€ã€Œä¸­æ­£æ©‹(å·²å»¢)ã€ã€ã€Œä¸­æ­£å¤§æ©‹ã€","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"2.
          è©¢å•ã€Œç«¹æ—å¤§æ©‹ã€â†’ åŒ¹é…ã€Œç«¹æ—å¤§æ©‹ã€ã€ã€Œç«¹æ—å¤§æ©‹(å·¦å²¸)ã€","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"###
          æ­¥é©Ÿ4ï¼šå“è³ªç¢ºèª","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"åœ¨è¼¸å‡ºå‰ç¢ºèªï¼š","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          [ ] å·²æª¢æŸ¥ CONTEXT ä¸­æ¯ä¸€ç­†è³‡æ–™","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          [ ] å·²å¥—ç”¨å¯¬é¬†åŒ¹é…åŸå‰‡","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          [ ] æœªå› ã€Œå·²å»¢ã€ç‹€æ…‹æ’é™¤æ¸¬ç«™","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"-
          [ ] è¼¸å‡ºæ ¼å¼æ­£ç¢º","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"<CONTEXT>","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"</CONTEXT>","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"#
          Output Format","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"åªè¼¸å‡º
          JSON æ ¼å¼ï¼Œç„¡å…¶ä»–æ–‡å­—ï¼š","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"\"result_type\":
          \"none|single|multiple\",","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"\"selected_stations\":
          [","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"{","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"\"station_name\":
          \"æ¸¬ç«™åç¨±\",","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"\"station_code\":
          \"æ¸¬ç«™ä»£ç¢¼\",","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"\"api_url\":
          \"APIç¶²å€\",","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"\"address\":
          \"æ¸¬ç«™åœ°å€\"","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"}","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"]","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"}","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""}],"direction":"ltr","format":"","indent":0,"type":"root","version":1}}'
        theme: blue
        title: ''
        type: ''
        width: 240
      height: 88
      id: '1753341315545'
      position:
        x: 2150.009474599445
        y: 700.809669750683
      positionAbsolute:
        x: 2150.009474599445
        y: 700.809669750683
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom-note
      width: 240
    viewport:
      x: -2495.4842834334986
      y: -122.50000000000159
      zoom: 1.0000000000000029
  rag_pipeline_variables: []
