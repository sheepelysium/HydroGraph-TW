# 快速開始指南

## 🎯 一鍵執行完整流程

如果原始資料已存在，直接執行以下命令產生最終報表：

```bash
# Windows
venv\Scripts\activate
python scripts\3_generate_final_report.py
```

輸出檔案：`data/測站河川配對分析報表.xlsx`

---

## 📝 完整流程（從頭開始）

### 1️⃣ 準備原始資料

確保以下檔案存在：
- `file/台灣地區河川代碼(112年).pdf`
- `data/測站基本資料2025.xlsx`

### 2️⃣ 提取河川資料

```bash
python scripts\1_extract_rivers_from_pdf.py
```

**輸出**：`data/河川關係_完整版.xlsx` (832條河川)

### 3️⃣ 提取測站資料

```bash
python scripts\2_extract_stations.py
```

**輸出**：`data/測站資料_水位與氣象.xlsx` (826個測站)

### 4️⃣ 產生配對報表

```bash
python scripts\3_generate_final_report.py
```

**輸出**：`data/測站河川配對分析報表.xlsx`

包含5個工作表：
1. 摘要統計 - 完整的統計分析
2. 能配對的測站 - 737個 (89.2%)
3. 無法配對的測站 - 89個 (10.8%)
4. 已配對的河川 - 181條 (21.8%)
5. 未配對的河川 - 651條 (78.2%) 待確認

---

## 📊 快速查看結果

打開 `data/測站河川配對分析報表.xlsx` 即可查看：

- **工作表1**：總體統計摘要
- **工作表2**：所有成功配對的測站（含河川代碼、匹配方式）
- **工作表3**：無法配對的測站（含原因分類）
- **工作表4**：已配對的河川列表（含測站數量）
- **工作表5**：未配對的河川列表（有待進一步確認）

---

## ⚡ 重點數據

```
測站配對率：89.2% (737/826)
已配對河川：21.8% (181/832)
未配對河川：78.2% (651條，有待進一步確認)
```

**注意**：「未配對河川」不代表沒有監測，可能原因包括：
- 測站資料未記錄河川欄位
- 河川名稱使用別名或地方名稱
- 測站設於主流但記錄為支流名稱

---

## 🔧 常見問題

### Q: 匹配率太低怎麼辦？
A: 腳本已使用智能匹配，能處理河川別名（如：`乾溪(里仁溪)`）。剩餘10.8%無法匹配的測站主要是：
- 河川欄位為空（24.7%）
- 小支流不在正式名錄（67.4%）
- 排水系統/灌溉渠道（6.7%）

### Q: 為什麼78.2%的河川沒有配對到測站？
A: 此數據需要進一步確認。可能的原因包括：
- 測站資料中有22個測站河川欄位為空
- 測站可能設於主流，但測站資料未標註所有涵蓋的支流
- 河川名稱可能使用不同的稱呼或別名
- 部分小支流可能確實未設置專屬測站

**建議**：配合實地資料或水利署官網交叉驗證

### Q: 報表中「匹配方式」是什麼意思？
A:
- **直接匹配**：測站河川名稱與河川資料完全一致
- **別名匹配**：透過括號內別名匹配（如：測站寫「東坑溪」，河川資料是「東興坑溪【東坑溪】」）

---

## 📖 詳細說明

查看 [README.md](README.md) 了解：
- 完整專案結構
- 技術實作細節
- 數據清理流程
- 未來發展規劃
